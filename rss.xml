<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[JyneeEarth | Feed]]></title><description><![CDATA[jynee's lab]]></description><link>https://jynee.github.io/tags#1st</link><generator>GatsbyJS</generator><lastBuildDate>Sun, 16 Aug 2020 23:57:06 GMT</lastBuildDate><item><title><![CDATA[GAN 이론]]></title><description><![CDATA[GAN 비지도학습(UL) 방식의 이미지, 문서, 음성 등의 데이터를 생성(모방)하는 알고리즘 비모수적방법으로도 비교적 정확한 sampling이 가능함  위조 데이터 생성 및 판별에 사용 
EX…]]></description><link>https://jynee.github.io/tags#1st/GAN_1/</link><guid isPermaLink="false">https://jynee.github.io/tags#1st/GAN_1/</guid><pubDate>Sat, 08 Aug 2020 00:00:00 GMT</pubDate><content:encoded>&lt;h1 id=&quot;gan&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#gan&quot; aria-label=&quot;gan permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;GAN&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;비지도학습(UL) 방식의 이미지, 문서, 음성 등의 데이터를 &lt;strong&gt;생성(모방)하는 알고리즘&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;비모수적방법&lt;/strong&gt;으로도 비교적 정확한 &lt;strong&gt;sampling이 가능&lt;/strong&gt;함 &lt;/li&gt;
&lt;li&gt;위조 데이터 생성 및 판별에 사용
EX) 이미지 색깔(색칠) 해주는 프로그램, 딥페이크 영상&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/ff466a3851f29e6c207a88c4333ce60e/32056/image-20200728184326510.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABgklEQVQoz31Su0oDURC9iBZaWfgZfomIH2BroYVEJCAWYqdfIGgKwcLaSkHsBEXUwsJCELNJ1GiMicnmscnexx5n7j7cQOKBKfbOzpk5Z0ZgBIIgsMHQxkDqvwhzSPLpf8V/hAxjAvSlTt4VEfaib005qQOYFLGI2YdFUqQ0+sqg1pa2uOlJ+z5M0dAJFXXlAi5mIl/p5J2D2mDv0sV87guHN23kv2VSayfk4jjiydLoSYWur+GRVNdTlnDrtA6x/ILxjIPZ3XcUaj1rhVAm9ISnYPMrrsT22Q8e3vp4rkrsnDfwWPbISyIkUpZLziJ7QoRLecxsvmLxqIpqyw8J7dYQSmN8ugpitYCpbAnTGyWawsF1vhtNaqwKpTUunjyS28JHUw2oESoirHckTWmok8JYpoiJNQeT6wWIFQe3BY9tp5y0ltQ7/sgzs4Qqui1GuSExt1/BwVULx/cdLOQquCt2kyK2hqXxkuOTSV+GXQrfGRvPkb65GOm8JTPBwK2mF/kL+MP0X/SgmJAAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;image 20200728184326510&quot;
        title=&quot;image 20200728184326510&quot;
        src=&quot;/static/ff466a3851f29e6c207a88c4333ce60e/fcda8/image-20200728184326510.png&quot;
        srcset=&quot;/static/ff466a3851f29e6c207a88c4333ce60e/12f09/image-20200728184326510.png 148w,
/static/ff466a3851f29e6c207a88c4333ce60e/e4a3f/image-20200728184326510.png 295w,
/static/ff466a3851f29e6c207a88c4333ce60e/fcda8/image-20200728184326510.png 590w,
/static/ff466a3851f29e6c207a88c4333ce60e/32056/image-20200728184326510.png 602w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;출처: &lt;a href=&quot;https://www.naverlabs.com/storyDetail/44&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://www.naverlabs.com/storyDetail/44&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;그림-보충-설명&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B7%B8%EB%A6%BC-%EB%B3%B4%EC%B6%A9-%EC%84%A4%EB%AA%85&quot; aria-label=&quot;그림 보충 설명 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;그림 보충 설명:&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Real&lt;/code&gt;: 실제 데이터(이미지, 음성 등)&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Input&lt;/code&gt;: 랜덤 데이터. &lt;strong&gt;노이즈 섞인 것&lt;/strong&gt;. 	&lt;em&gt;But,&lt;/em&gt; Generator 통과하면, Real data 같은 것으로 변환돼 나온다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Generator(network)&lt;/code&gt;: 생성자. &lt;strong&gt;진짜 같은 가짜(Fake) 생성&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Discriminator(network)&lt;/code&gt;: 판별자. &lt;strong&gt;실제 데이터(Real)와 가짜 데이터(Fake)를 판별&lt;/strong&gt;함&lt;/li&gt;
&lt;/ol&gt;
&lt;br&gt;
&lt;br&gt;
&lt;h2 id=&quot;즉-총-2개의-네트워크-사용&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A6%89-%EC%B4%9D-2%EA%B0%9C%EC%9D%98-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%EC%82%AC%EC%9A%A9&quot; aria-label=&quot;즉 총 2개의 네트워크 사용 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;strong&gt;즉, 총 2개의 네트워크 사용:&lt;/strong&gt;&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Discriminator&lt;/code&gt;: real or fake 판별자&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Generator&lt;/code&gt;: fake 생성자&lt;/li&gt;
&lt;/ol&gt;
&lt;br&gt;
&lt;br&gt;
&lt;h2 id=&quot;gan의-loss-function&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#gan%EC%9D%98-loss-function&quot; aria-label=&quot;gan의 loss function permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Gan의 loss function:&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;minGmaxDV(D,G) = logD(x) + log(1-D(G(z)))&lt;code class=&quot;language-text&quot;&gt;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;학습을 반복하여 (Pg = Pdata가 되어) Discriminator가 구별 불가능인 상태(‘D(x)=0.5’)로 수렴하도록
→ 마치 Generator가 x를 만들어낸 것처럼 됨 &lt;/li&gt;
&lt;/ul&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Discriminator&lt;/th&gt;
&lt;th&gt;Generator&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;엔트로피 최대화&lt;/td&gt;
&lt;td&gt;엔트로피 최소화&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;엔트로피: 정보의 가치(정보량)과 ~&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;1)&lt;/strong&gt;  &lt;strong&gt;&lt;code class=&quot;language-text&quot;&gt;Discriminator&lt;/code&gt;&lt;/strong&gt;(network): &lt;strong&gt;&lt;code class=&quot;language-text&quot;&gt;maxV(D, G)&lt;/code&gt;&lt;/strong&gt;로 학습. D(x) = 1 and D(G(z)) = 0일 때 최대&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;why?&lt;/em&gt; D(G(z))가 1이 되고, D(x)가 1이 되니까&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code class=&quot;language-text&quot;&gt;Generator&lt;/code&gt;&lt;/strong&gt; network: &lt;strong&gt;&lt;code class=&quot;language-text&quot;&gt;minV(G)&lt;/code&gt;&lt;/strong&gt;로 학습. D(G(z)) = 1 일 때 최소. 이때(D(x)는 상관 X)&lt;/li&gt;
&lt;li&gt;&lt;em&gt;why?&lt;/em&gt; D(G(z))가 0이 되니까&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;
&lt;h3 id=&quot;원리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9B%90%EB%A6%AC&quot; aria-label=&quot;원리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;원리:&lt;/h3&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/6be073ef6d6fa9dd4ff79d7d459669c9/32056/image-20200728185621472.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 41.891891891891895%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABSUlEQVQoz31R2W7DMAzL//9c99Khd9cka27ncNw0jm1OUtECG4oZIGg7MUVK0Xr9idXqA7vdHpvNFvv9QXA8nnA4HBHHiezP5y85Z1kGXiEEwd8V1XWN7XaHJElR5AX4bG433O93zPMsPE0TbnI3wzn3EnuHiFW5MuN6zVCVFS7kSDUK42jIUS7gb22rRPi/FbGq1hpVVSMnh6ppoIhb4kYpctxgtuwswJiFXDsS9QJrA7n3AmO8/BMtyyKC4zii7TqJ+4zHcbUeoUdNDyYMw0OMmQWee2atHZaFBPkRNzxJv5FTtPwSIzmdpJdFUYrzYRhE2Dn/6pX34X1k7/2vaU3kriQhYwwJaWEehLUefR/ozqPrHBVcoNTDFUfl+FwkqskBT5h7pahn7KQnRx3F7/seHaPrpS3MPKgQWNQiTSc0zYyynIWtdfgBzhpml1rCyu4AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;image 20200728185621472&quot;
        title=&quot;image 20200728185621472&quot;
        src=&quot;/static/6be073ef6d6fa9dd4ff79d7d459669c9/fcda8/image-20200728185621472.png&quot;
        srcset=&quot;/static/6be073ef6d6fa9dd4ff79d7d459669c9/12f09/image-20200728185621472.png 148w,
/static/6be073ef6d6fa9dd4ff79d7d459669c9/e4a3f/image-20200728185621472.png 295w,
/static/6be073ef6d6fa9dd4ff79d7d459669c9/fcda8/image-20200728185621472.png 590w,
/static/6be073ef6d6fa9dd4ff79d7d459669c9/32056/image-20200728185621472.png 602w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;출처: Goodfellow 논문 공식&lt;/p&gt;
&lt;/blockquote&gt;
&lt;br&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Discriminator&lt;/code&gt;를 k번 학습시키고, &lt;code class=&quot;language-text&quot;&gt;Generator&lt;/code&gt;를 1번 학습시킨다.&lt;/p&gt;
&lt;p&gt;→ D가 G보다 더 많이 학습된다.    * D: Discriminator / * G: Generator&lt;/p&gt;
&lt;br&gt;
&lt;p&gt;&lt;em&gt;이에 따라&lt;/em&gt; &gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Real Data와 Fake Data를 구별해내는 &lt;code class=&quot;language-text&quot;&gt;D loss&lt;/code&gt;는 점점 더 작아져 영향력이 줄어들고,&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;D&lt;/code&gt;와 &lt;code class=&quot;language-text&quot;&gt;G&lt;/code&gt;는 점점 더 비슷해지며,&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;KL&lt;/code&gt;이 적어지고,   &lt;strong&gt;*&lt;/strong&gt;KL: G와 D의 정보량의 차이/분산의 차이&lt;/li&gt;
&lt;/ol&gt;
&lt;br&gt;
&lt;p&gt;&lt;em&gt;이럴수록&lt;/em&gt; &gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;​	3-1) G가 더 많은 영향력을 행사하고(역할을 하고),&lt;/p&gt;
&lt;p&gt;​	3-2) &lt;code class=&quot;language-text&quot;&gt;D loss&lt;/code&gt;를 계산하는 공식 中 [-log4 + 2JSD(Pdata+||Pg)]에서 -log4의 값이 더욱더 1.38에 가까워진다.
​    *[2JSD(Pdata+||Pg) ] : KL이라 보면 됨. (KL이 작아진다) = (D와 G의 분산이 적다) = (D loss가 1.38에 가깝다)&lt;/p&gt;
   &lt;br&gt;
&lt;p&gt;   &lt;em&gt;따라서&lt;/em&gt;  &gt;&lt;/p&gt;
&lt;p&gt;   분별할 수 없이 실제와 가까운 Fake Data가 생성된다.&lt;/p&gt;
&lt;br&gt;
&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;위 원리에 따라,&lt;/p&gt;
&lt;p&gt;&lt;em&gt;학습이 안 된 상태에선&lt;/em&gt; &gt;&lt;/p&gt;
&lt;p&gt;G(z) ( = Fake Data. 이때 ‘z’는 input에서 들어온 random data임)의 분포가 오른쪽으로 치우친 상태로서 D(x)는 1에 가까운 값이 출력되고 D(G(z))는 0에 가까운 값이 출력된다.&lt;/p&gt;
&lt;p&gt;&lt;sup id=&quot;fnref-1&quot;&gt;&lt;a href=&quot;#fn-1&quot; class=&quot;footnote-ref&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;: 이때 D와 G는 아래 함수와 같은 상태임&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 377px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/7329e5014c8de29c438849a8359f8ee5/6146e/image-20200728190633284.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 16.216216216216214%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsSAAALEgHS3X78AAAAnUlEQVQI1z1PSwqFMBDz/sfxAuJKwR/oQt2KC0EQaj/W/iLTPt4iZCaESSYzxkNrB2LOLYDwA6LGWNKex0WEECClw31bKJU02oVInC2LQp5faFuBpuE4jhf7riOmSaKuOaqKoygY1lXFI+MoUZYs+vteYBgEuk5gnhUyakHG901NKZmObZvGeZrY8rpM1K31cM7De//3UwC1o+9o/gBXXeO5Ghev+wAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;image-20200728190633284&quot;
        title=&quot;image-20200728190633284&quot;
        src=&quot;/static/7329e5014c8de29c438849a8359f8ee5/6146e/image-20200728190633284.png&quot;
        srcset=&quot;/static/7329e5014c8de29c438849a8359f8ee5/12f09/image-20200728190633284.png 148w,
/static/7329e5014c8de29c438849a8359f8ee5/e4a3f/image-20200728190633284.png 295w,
/static/7329e5014c8de29c438849a8359f8ee5/6146e/image-20200728190633284.png 377w&quot;
        sizes=&quot;(max-width: 377px) 100vw, 377px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/112ffbe40ca0e7e655685f848da8bdb7/32056/image-20200728190622855.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 9.45945945945946%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsSAAALEgHS3X78AAAAbklEQVQI1yWMSwqAMAxEvf/1ClYENy3oQvBTbVqbyEji4jHhZZLOe0IIFfvOxrI86HuCcxnjSIixYp4f4zgY01Rsp1772lU3DH92KmsVbFvDujakxLhvMYgEpQhae3FdYg9yFpwnm2d+7VZn9Zofk++YH5r8gOMAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;image-20200728190622855&quot;
        title=&quot;image-20200728190622855&quot;
        src=&quot;/static/112ffbe40ca0e7e655685f848da8bdb7/fcda8/image-20200728190622855.png&quot;
        srcset=&quot;/static/112ffbe40ca0e7e655685f848da8bdb7/12f09/image-20200728190622855.png 148w,
/static/112ffbe40ca0e7e655685f848da8bdb7/e4a3f/image-20200728190622855.png 295w,
/static/112ffbe40ca0e7e655685f848da8bdb7/fcda8/image-20200728190622855.png 590w,
/static/112ffbe40ca0e7e655685f848da8bdb7/32056/image-20200728190622855.png 602w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;즉, D는 진짜 (X)와 가짜 G(z)를 잘 구별하고, &lt;code class=&quot;language-text&quot;&gt;G&lt;/code&gt;는 진짜 같은 가짜를 잘 못 만든다&lt;/p&gt;
&lt;br&gt;
&lt;p&gt;&lt;em&gt;학습이 진행되면&lt;/em&gt; &gt; &lt;/p&gt;
&lt;p&gt;가짜 데이터 G(z)의 분포가 점점 Real Data( = X)의 분포와 유사해지고 D(G(z)) 값도 점차 커져서 D(x)값은 점차 작아진다 &lt;/p&gt;
&lt;br&gt;
&lt;p&gt;&lt;em&gt;학습이 완료되면&lt;/em&gt; &gt; &lt;/p&gt;
&lt;p&gt;Real data와 G(z)의 분포가 잘 일치하고 “D(x) = D(G(z)) = 0.5 “로 수렴한다.&lt;/p&gt;
&lt;p&gt;즉, 임의의 random data를 G에 입력해 나온 Fake data는 Real data와 유사한 분포 특성을 갖는 데이터가 출력된다.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/4fb82e1ce3bea1e96e8be416befbd8a0/32056/image-20200728190502482.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 31.756756756756754%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAABCElEQVQY00VR2XKDMAzM//9d+tRMkpeUI4AhYGMDPthq3ZBqZse2jtVKPu37DoK2LAuMMZjnGdZaOOfQdR3Ksvz4CN4ZI0IIOIw8p+NCSykJqYP3HjFERnIBwRjzQgyffPqtnTMO4tMRJAkVar2hKGtoMwlpkrcULDaTJ+lBxSH4TOrcgn54oVM9nHXiS38K2Z2E3ktHt6IbRihJ5GhaVtAMCmY2mKYJqioxjeN7RRvUS6MXBB//R6YyFvN8tjW+LxfUdYvNb3gUD5zPX7LbOZNeb1dU9fNN6HC/31AUP0iiLo9MkuMDqFJrjaqqpIFBjBFKqTwmp1jXVRrVGXwH2XPTNGjbNsdovxtm0E5Ax17BAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;image 20200728190502482&quot;
        title=&quot;image 20200728190502482&quot;
        src=&quot;/static/4fb82e1ce3bea1e96e8be416befbd8a0/fcda8/image-20200728190502482.png&quot;
        srcset=&quot;/static/4fb82e1ce3bea1e96e8be416befbd8a0/12f09/image-20200728190502482.png 148w,
/static/4fb82e1ce3bea1e96e8be416befbd8a0/e4a3f/image-20200728190502482.png 295w,
/static/4fb82e1ce3bea1e96e8be416befbd8a0/fcda8/image-20200728190502482.png 590w,
/static/4fb82e1ce3bea1e96e8be416befbd8a0/32056/image-20200728190502482.png 602w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;참고:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt; &lt;a href=&quot;http://blog.skby.net/gan-generative-adversarial-networks/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;http://blog.skby.net/gan-generative-adversarial-networks/&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;footnotes&quot;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&quot;fn-1&quot;&gt;
&lt;p&gt;&apos;D(x)는 1에 가까운 값이 출력되고 D(G(z))는 0에 가까운 값이 출력된다&apos;&lt;/p&gt;
&lt;a href=&quot;#fnref-1&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content:encoded></item><item><title><![CDATA[GAN 실전 응용]]></title><description><![CDATA[GAN 1D 정규분포에서 샘플링한 데이터를 모방하여, fake data를 생성한다. fake data는 정규분포의 특성을 갖는다. (KL divergence, 평균, 분산, 왜도, 첨도 등) Discrimi의 loss는 maxlog(Dx) + log…]]></description><link>https://jynee.github.io/tags#1st/GAN_2/</link><guid isPermaLink="false">https://jynee.github.io/tags#1st/GAN_2/</guid><pubDate>Sat, 08 Aug 2020 00:00:00 GMT</pubDate><content:encoded>&lt;h1 id=&quot;gan&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#gan&quot; aria-label=&quot;gan permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;GAN&lt;/h1&gt;
&lt;/br&gt;
&lt;ul&gt;
&lt;li&gt;1D 정규분포에서 샘플링한 데이터를 모방하여, fake data를 생성한다.&lt;/br&gt;&lt;/li&gt;
&lt;li&gt;fake data는 정규분포의 특성을 갖는다. (KL divergence, 평균, 분산, 왜도, 첨도 등)&lt;/br&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Discrimi의 loss는 max[log(Dx) + log(1 - DGz)]이고, Generator의 loss는 min[log(Dx + log(1 - DGz))]이다. &lt;/br&gt;&lt;/p&gt;
&lt;/br&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Tensorflow에서는 이 loss 함수를 이용하여 직접 GAN을 학습할 수 있지만, &lt;/br&gt;&lt;/p&gt;
&lt;p&gt;Keras에서는 model.fit(), model.train&lt;em&gt;on&lt;/em&gt;batch() 함수에서 target 값을 지정해야 하기 때문에 이 loss로 GAN을 학습할 수 없다 &lt;strong&gt;Keras는 기본적으로 Supervised learning 목적이다.&lt;/strong&gt;&lt;/br&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Keras에서는 supervised learning 방식으로 바꿔 binary_crossentropy loss 함수를 써서 GAN을 학습하는 것이 보통이다.&lt;/br&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;이 코드는 아래 자료를 참조해서 응용했다.&lt;/br&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Rowel Atienza, 2018, Advanced Deep Learning with Keras. Chap 4. p.107 ~ p.113&lt;/br&gt;&lt;/li&gt;
&lt;li&gt;아마추어 퀀트, blog.naver.com/chunjein,  2020.04.08&lt;/br&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;함수들의 기능을 파악하기 쉽도록 순서를 변경하였다.&lt;/br&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/br&gt;
&lt;/br&gt;
&lt;h2 id=&quot;basic-code&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#basic-code&quot; aria-label=&quot;basic code permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Basic CODE&lt;/h2&gt;
&lt;/br&gt;
&lt;ul&gt;
&lt;li&gt;Keras를 이용하여 기본 GAN 모델을 연습한다.&lt;/br&gt;&lt;/li&gt;
&lt;li&gt;file: 딥러닝 8-2.GAN(Kears)&lt;/br&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/br&gt;
&lt;h4 id=&quot;step1-정규분포로부터-데이터를-샘플링한다br&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#step1-%EC%A0%95%EA%B7%9C%EB%B6%84%ED%8F%AC%EB%A1%9C%EB%B6%80%ED%84%B0-%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A5%BC-%EC%83%98%ED%94%8C%EB%A7%81%ED%95%9C%EB%8B%A4br&quot; aria-label=&quot;step1 정규분포로부터 데이터를 샘플링한다br permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;step1. 정규분포로부터 데이터를 샘플링한다&lt;/br&gt;&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;realData &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;random&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;normal&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;size&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
realData &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; realData&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;reshape&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;realData&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;shape&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/br&gt;
&lt;h4 id=&quot;step2-network-빌드&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#step2-network-%EB%B9%8C%EB%93%9C&quot; aria-label=&quot;step2 network 빌드 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;step2. Network 빌드&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;nDInput &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; realData&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;shape&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# nDInput.shape[1] = 1&lt;/span&gt;
nDHidden &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;32&lt;/span&gt;
nDOutput &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
nGInput &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;16&lt;/span&gt;
nGHidden &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;32&lt;/span&gt;
nGOutput &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; nDInput

&lt;span class=&quot;token comment&quot;&gt;## nDInput와 nGOutput는 값이 같아야 함&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/br&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getNoise&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;m&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; n&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;nGInput&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    z &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;random&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;uniform&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; size&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;m&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; n&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; z&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;MyOptimizer&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;a &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.001&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; RMSprop&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;lr &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; a&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/br&gt;
&lt;h4 id=&quot;step3-모델-그림&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#step3-%EB%AA%A8%EB%8D%B8-%EA%B7%B8%EB%A6%BC&quot; aria-label=&quot;step3 모델 그림 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;step3. 모델 그림&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;py&quot;&gt;&lt;pre class=&quot;language-py&quot;&gt;&lt;code class=&quot;language-py&quot;&gt;Generator &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; Discriminator를 연결한 모델을 생성한다&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
아래 네트워크로 z가 들어가면 DGz &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;이 나오도록 G를 학습한다&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
D 네트워크는 업데이트하지 않고&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; G 네트워크만 업데이트한다&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;

        &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;   Gz   &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;
  z &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; G &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; D &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; DGz
        &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;        &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;
      trainable   &lt;span class=&quot;token keyword&quot;&gt;not&lt;/span&gt; trainable&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/br&gt;
&lt;/br&gt;
&lt;h4 id=&quot;step4-객체지향-함수-정의&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#step4-%EA%B0%9D%EC%B2%B4%EC%A7%80%ED%96%A5-%ED%95%A8%EC%88%98-%EC%A0%95%EC%9D%98&quot; aria-label=&quot;step4 객체지향 함수 정의 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;step4. (객체지향) 함수 정의&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;0. K.clear_session()&lt;/br&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;h5 id=&quot;1-discriminator--builddiscriminatorbr&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1-discriminator--builddiscriminatorbr&quot; aria-label=&quot;1 discriminator  builddiscriminatorbr permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1. Discriminator = BuildDiscriminator()&lt;/br&gt;&lt;/h5&gt;
&lt;h5 id=&quot;2-generator--buildgeneratorbr&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#2-generator--buildgeneratorbr&quot; aria-label=&quot;2 generator  buildgeneratorbr permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2. Generator = BuildGenerator()&lt;/br&gt;&lt;/h5&gt;
&lt;h5 id=&quot;3-gan--buildgandiscriminator-generatorbr&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#3-gan--buildgandiscriminator-generatorbr&quot; aria-label=&quot;3 gan  buildgandiscriminator generatorbr permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3. GAN = BuildGAN(Discriminator, Generator)&lt;/br&gt;&lt;/h5&gt;
&lt;/br&gt;
&lt;/br&gt;
&lt;h4 id=&quot;step5-학습-세팅&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#step5-%ED%95%99%EC%8A%B5-%EC%84%B8%ED%8C%85&quot; aria-label=&quot;step5 학습 세팅 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;step5. 학습 세팅&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;nBatchCnt &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;       &lt;span class=&quot;token comment&quot;&gt;# Mini-batch를 위해 input 데이터를 n개 블록으로 나눈다. # 333개, 333개, 334개로 쪼개짐 &lt;/span&gt;
nBatchSize &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;realData&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;shape&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt; nBatchCnt&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 블록 당 Size # nBatchSize: 333개, 333개, 334개 순으로 들어감 &lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; epoch &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# Mini-batch 방식으로 학습한다&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; n &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;nBatchCnt&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# input 데이터를 Mini-batch 크기에 맞게 자른다&lt;/span&gt;
        nFrom &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; n &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; nBatchSize &lt;span class=&quot;token comment&quot;&gt;#for문 다 돌면 nFrom= 666&lt;/span&gt;
        nTo &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; n &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; nBatchSize &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; nBatchSize &lt;span class=&quot;token comment&quot;&gt;#for문 다 돌면 nTo=1000&lt;/span&gt;
        
        &lt;span class=&quot;token comment&quot;&gt;# 마지막 루프이면 nTo는 input 데이터의 끝까지. &lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;## 왜 써주냐면 , n=2(마지막)일때 nTo = n * nBatchSize + nBatchSize는 999로 1000이 안되기 땜에.&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; n &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; nBatchCnt &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            nTo &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; realData&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;shape&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/br&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;        &lt;span class=&quot;token comment&quot;&gt;# 학습 데이터를 준비한다&lt;/span&gt;
        bx &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; realData&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;nFrom &lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; nTo&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;#진짜 data 형성&lt;/span&gt;
        bz &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; getNoise&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;m&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;bx&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;shape&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; n&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;nGInput&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# bx.shape[0]=333-&gt;333-&gt;334, nGInput=16&lt;/span&gt;
        Gz &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Generator&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;predict&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;bz&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;#진짜 data shape 맞춰서 noise 써가지고 가짜 data 형성(fake data)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 410px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/300cd66c5e4a62c747237923b76d20a9/d68e4/image-20200715110832016.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 102.7027027027027%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAAAsSAAALEgHS3X78AAADGUlEQVQ4y4VU2XKbQBDk/38p5Tw4kQ/FkqwbgUBC3OhE6LKjqvb0IGw5FScPU8Ay29PT07vGYRcjX8+wWc1w3Cc4HVK8HDMcdgn2RQz+v459Eb2/M7+Kas2Ypw7Mfh1xMELoDzW8SQ9FHgh4dgGVQrIp3/g47pL3Yvnax1bW1ksPu22k60YaW1jOXamSYrWYKtM4HCGJLA0CFVLZSyzEqymihYuDgAWzoUYSWnDsZ/izgXZmLOcTXWg+3aLVuMVY3gkaBSayZAxr+ISB00JvUIfZqyNIx4iysXRkCoFyb5GH2hnlMkjbc7vaP6mT5W4bqgTbTYDR4BdsrwvbaaMhRa1JB/O1hyyykcY22q0a7mrfMOg9qkTGZuXBlE1kwxaZxKqRADJY5CiVXWl5EPThhEOcTwtMhQT3kAj32KOWMjU44YlUpx4Tp6P6UdNANKmml0tizXzETb8GU0AJGIt2gTfA2GrpXhanAwyiWmZDqZO2Y7d0csFF5MomSym8FSkKCX5Tr/PrAr6AkkBlI4MDKAXNVDMGk1mV76X3JJk+K8rgt9pEALrtex0gXaIM2fJQfMhFsmKwAHUkYNl22fr+3eDl9+tpjrXMgIN9Oc5LH/Jj6nY0gdNlu3zOxNz8d30KDleAzGHx2bQn0deOyNygTWjuLHHgy49F5uopIWOy/xsgp06pSKTV/KG5BCYZg06nNZ6bP1F/+I6H+xuxj61TzFdfAO5LQErDvNA3laXahgzpv1iCnswSW9th0pcML4BkxUGQEC1HzS8+LDUkIMHOr0ut/hWgaihAJOLK8OhH+lc1LMUdqsDUIpR33+urYSvbXF9dBKps9HLK0BXvroTIbzG7AjKRBuZPts+hUFwO5lObtAnNzFwORf67cgwbnTtMIhNzAeXVZlSVaWZr1NDTQn991kzuQgEYC0DTbSJdTjBLbWWXi36RyOMKaCFmNw5/mJUSXN/K19GZtnFn1eHEJmI5bryBHJGGt83Ik0u5+AT472DLvGzPciLYMrWMhelUbqFxNMSCFqta/n98HL2K/cdNFOj6SazEvDfbQBgvvvdP4gAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;image-20200715110832016&quot;
        title=&quot;image-20200715110832016&quot;
        src=&quot;/static/300cd66c5e4a62c747237923b76d20a9/d68e4/image-20200715110832016.png&quot;
        srcset=&quot;/static/300cd66c5e4a62c747237923b76d20a9/12f09/image-20200715110832016.png 148w,
/static/300cd66c5e4a62c747237923b76d20a9/e4a3f/image-20200715110832016.png 295w,
/static/300cd66c5e4a62c747237923b76d20a9/d68e4/image-20200715110832016.png 410w&quot;
        sizes=&quot;(max-width: 410px) 100vw, 410px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;/br&gt;
&lt;h5 id=&quot;discriminator--builddiscriminator&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#discriminator--builddiscriminator&quot; aria-label=&quot;discriminator  builddiscriminator permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Discriminator = BuildDiscriminator()&lt;/h5&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;    	&lt;span class=&quot;token comment&quot;&gt;### &amp;lt; Discriminator를 학습한다. &gt; ###&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# Real data가 들어가면 Discriminator의 출력이 &apos;1&apos;이 나오도록 학습하고,&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# Fake data (Gz)가 들어가면 Discriminator의 출력이 &apos;0&apos;이 나오도록 학습한다.&lt;/span&gt;
        &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot;target data 만들기&quot;&quot;&quot;&lt;/span&gt;
        target &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;zeros&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;bx&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;shape&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        target&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; bx&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;shape&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.9&lt;/span&gt;     &lt;span class=&quot;token comment&quot;&gt;# &apos;1&apos; 대신 0.9로 함&lt;/span&gt;
        target&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;bx&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;shape&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.1&lt;/span&gt;     &lt;span class=&quot;token comment&quot;&gt;# &apos;0&apos; 대신 0.1로 함&lt;/span&gt;
        &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot;target data 형성 완료&quot;&quot;&quot;&lt;/span&gt;
        
        bx_Gz &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;concatenate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;bx&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Gz&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# D 학습 &lt;/span&gt;
        Dloss &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Discriminator&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;train_on_batch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;bx_Gz&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; target&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 
        &lt;span class=&quot;token comment&quot;&gt;#real data &amp;amp; fake data 모두가 D를 거치게 한다. &lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;##참고: fit 함수보다 train_on_batch 쓰는 게 더 속도가 빨라서 이거 씀&lt;/span&gt;
 &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 310px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/98081371ab2415f2244c7b50905f4563/5fad2/image-20200715110841184.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 85.8108108108108%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsSAAALEgHS3X78AAAC2UlEQVQ4y2VUaXeaUBDl//+Mfm97emo/tGlimibGeFww7iiKuIAI4sbiktzOjGBM+uEdYHjvzr13Zp4SbCwEWwtxYCOiFW5tbDdTiQX05Nh2PcEumCFKYiE9eQUX36d3CwoHGMy0NcwXQwE7hA524UyWvxzhEDmw3D5Wq7GAMgA/0yRRQojJKIzKG2xvIAcaZg1PegntcQN1o4q7dh4VQ0VrVMeS/gs7OrMm1s7CkISb9RSOZ8h5JTxntHGMXVS6JXz9k0G2lEWufIdiNYcf+Z/wfJMYOyKL2YycLr5XbpCh9SmXwb1WEPlKqp99Yr9Wngm9UxY5LP0Yz6FrKhbEIAptOcT7eS+zZJvmxHTD50+STx4e6fDLzsXSG6LfUyXBwjUQk49GvyZx8TXxjYmwXJfA9hQPkwIpMW2YzHU8dgpQyTNvYaJefUSNpGavM1jSNwNqwzrMWRe59hNsKtCeCrVcjsWKU3eckijsS9/SyIssrpsP6Jh1dJpFVEp/MRm1xDPTaGDuDuCvx9AmLTJ/ImxdfyjgzDpIAVMP2QPsPfgkrcceEoOVPxLZzHhFTOOz5DdG6/VbKwlg2jYhNyhRXxCTQv4GA70KvVvBxGyh2XiSRCxNikJrR+8Dq4MZtVt8jltvbZNOhU/VHA5qeD36wvLlsKDvugAyQ+kI2suFYE+n5P8uKcpZcph0+uvOE2kMyP5Zk86HKjsid59M0pT8qw5UKVDwXrJNnT4Uww1aIypCo5bH71/fUCzcot9V4c5pkshnl6qqT9vSozOyp0f7GVzuBJbMGXlkvhSv8Ll0hZvGPZrtokjkSj+rDzD0ZwE0Zz2U9bKsF2p4l5raoDtAPPwomX+ylJjbqFel2FR8BFYCyN4eCCQdvSjx8vLC+M9DmRoC5LYx+s9UZZXGroJOqySTE14cDJPxiz7Ezm2TtkNEfeY6Ouyphg1lX9N4pWDpnvd34MX9SFj/AOky8Iew8ES7AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;image-20200715110841184&quot;
        title=&quot;image-20200715110841184&quot;
        src=&quot;/static/98081371ab2415f2244c7b50905f4563/5fad2/image-20200715110841184.png&quot;
        srcset=&quot;/static/98081371ab2415f2244c7b50905f4563/12f09/image-20200715110841184.png 148w,
/static/98081371ab2415f2244c7b50905f4563/e4a3f/image-20200715110841184.png 295w,
/static/98081371ab2415f2244c7b50905f4563/5fad2/image-20200715110841184.png 310w&quot;
        sizes=&quot;(max-width: 310px) 100vw, 310px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;/br&gt;
&lt;h6 id=&quot;def-builddiscriminator&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#def-builddiscriminator&quot; aria-label=&quot;def builddiscriminator permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;def BuildDiscriminator()&lt;/h6&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# Discriminator를 G. D 각각 생성한다&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;BuildDiscriminator&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Input&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;batch_shape &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; nDInput&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    h &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Dense&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;nDHidden&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; activation &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;relu&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    Dx &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Dense&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;nDOutput&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; activation &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;sigmoid&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;h&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;#0이면 가짜, 1이면 진짜로 하려고 sigmoid를 출력값으로 &lt;/span&gt;
    model &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Model&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Dx&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;loss &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;binary_crossentropy&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; optimizer &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; MyOptimizer&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0.001&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 
    &lt;span class=&quot;token comment&quot;&gt;#sigmoid 짝꿍 binary_crossentropy를 loss에 넣어서 1과 0 값이 출력되게 함 &lt;/span&gt;
    
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; model&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/br&gt;
&lt;/br&gt;
&lt;h5 id=&quot;gan--buildgandiscriminator-generator&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#gan--buildgandiscriminator-generator&quot; aria-label=&quot;gan  buildgandiscriminator generator permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;GAN = BuildGAN(Discriminator, Generator)&lt;/h5&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;### &amp;lt; Generator를 학습한다. &gt; ###&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# Fake data (z --&gt; Gz --&gt; DGz)가 들어가도 Discriminator의 출력이 &apos;1&apos;이 나오도록 Generator를 학습한다.&lt;/span&gt;
&lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot;target data 만들기&quot;&quot;&quot;&lt;/span&gt;
target &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;zeros&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;bx&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;shape&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
target&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.9&lt;/span&gt;
&lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot;target data 형성 완료&quot;&quot;&quot;&lt;/span&gt;
        
Gloss &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; GAN&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;train_on_batch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;bz&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; target&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 
&lt;span class=&quot;token comment&quot;&gt;## GAN 함수 참고: D는 위에서 학습해서 여기선 학습 안 하고 G만 학습 &lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# 어떤 학습? 가짜 data가 들어가면 target이 전부 1로 출력되도록(Discriminator가 전부 진짜로 판별하도록)! &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 448px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/97569fb6e53b4464c4b19ffaa74c0241/33b38/image-20200715110850214.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 59.45945945945946%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAABsElEQVQoz11T2VLCQBDM/3+Gj/oNPmhpiSAhIEeICSHk2oT7Ri1rnJ6wIfCwtdmdmZ7uno1x2KV03Gd0OmS8K8L5dFC03ya0XoZ8VhKb5R6tFhP6OU0ljjvk6oV87AZAZvlI1nzq024TC9DY69CgV6c0dmiqPDI/nsnuN8jn+1nmkUoc2qzCM5AqyRjo6DoWdaxXGnTrtJwHNHIt8pwW9T7fOdaiwO/yd43B2txgKDkAbzaeyDJfhIAmYxR0Uz4UEtEJctLIJsduilTE3aFJYdA/W5Ixu0hiOLcY9OH+TuJG1YfjvvACoFj6GzvkbdexyEPu9zEvm0/ZgjDoicfGrbFIgiRIiyZ9ypVbgqA4Zz/BPGEFeni410NlwEQkaUAE0A2+wZcJf0OeZh2HAwH03bZ4puvKKV8Y6m5KgGpvjzLlJLSlcDzqyITBGKBgj3s9Xb2uAAsflXiRqy/6+51L8XYdiQ0YGp6RAAZVQHUNWJWMhMVsTF+2yT4NhZUuxCCiyUDeIGzRkq8e9i1DvcAK3uE5lQUMCpYYCJpW5WpSxuXJVAFVOYRbjzTTy69XlazoHzpngHnz2qseAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;image-20200715110850214&quot;
        title=&quot;image-20200715110850214&quot;
        src=&quot;/static/97569fb6e53b4464c4b19ffaa74c0241/33b38/image-20200715110850214.png&quot;
        srcset=&quot;/static/97569fb6e53b4464c4b19ffaa74c0241/12f09/image-20200715110850214.png 148w,
/static/97569fb6e53b4464c4b19ffaa74c0241/e4a3f/image-20200715110850214.png 295w,
/static/97569fb6e53b4464c4b19ffaa74c0241/33b38/image-20200715110850214.png 448w&quot;
        sizes=&quot;(max-width: 448px) 100vw, 448px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;/br&gt;
&lt;h6 id=&quot;def-buildgand-g&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#def-buildgand-g&quot; aria-label=&quot;def buildgand g permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;def BuildGAN(D, G)&lt;/h6&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;BuildGAN&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;D&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; G&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# 전체 NETWORK Build &lt;/span&gt;
    D&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;trainable &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;     &lt;span class=&quot;token comment&quot;&gt;# Discriminator는 업데이트하지 않는다= 학습하지 않는다. 왜냐면 자체적으로 위에서 학습했으니까. 따라서 G만 학습됨 &lt;/span&gt;
    z &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Input&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;batch_shape&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; nGInput&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    Gz &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; G&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;z&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    DGz &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; D&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Gz&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    
    model &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Model&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;z&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; DGz&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;#z가 들어가면 최종적으로 DGz가 나온다. &lt;/span&gt;
    model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;loss &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;binary_crossentropy&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; optimizer &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; MyOptimizer&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0.0005&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# binary_crossentropy: 출력값이 0 아니면 1 나오도록&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; model&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/br&gt;
&lt;h6 id=&quot;def-builddiscriminator--discriminator&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#def-builddiscriminator--discriminator&quot; aria-label=&quot;def builddiscriminator  discriminator permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;def BuildDiscriminator() = Discriminator&lt;/h6&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# Discriminator를 G. D 각각 생성한다&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;BuildDiscriminator&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Input&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;batch_shape &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; nDInput&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    h &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Dense&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;nDHidden&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; activation &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;relu&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    Dx &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Dense&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;nDOutput&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; activation &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;sigmoid&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;h&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;#0이면 가짜, 1이면 진짜로 하려고 sigmoid를 출력값으로 &lt;/span&gt;
    model &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Model&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Dx&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;loss &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;binary_crossentropy&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; optimizer &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; MyOptimizer&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0.001&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 
    &lt;span class=&quot;token comment&quot;&gt;#sigmoid 짝꿍 binary_crossentropy를 loss에 넣어서 1과 0 값이 출력되게 함 &lt;/span&gt;
    
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; model&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/br&gt;
&lt;h6 id=&quot;def-buildgenerator--generator&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#def-buildgenerator--generator&quot; aria-label=&quot;def buildgenerator  generator permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;def BuildGenerator() = Generator&lt;/h6&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# Generator를 생성한다 &lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# G는 여기서 학습 안 하므로 &apos;.complie&apos; 안 함 &lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;BuildGenerator&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 
    z &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Input&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;batch_shape &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; nGInput&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    h &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Dense&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;nGHidden&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; activation &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;relu&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;z&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    Gz &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Dense&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;nGOutput&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; activation&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;linear&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;h&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; Model&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;z&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Gz&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/br&gt;
&lt;h5 id=&quot;kd--klraldata-fakedata&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#kd--klraldata-fakedata&quot; aria-label=&quot;kd  klraldata fakedata permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;kd = KL(ralData, fakeData)&lt;/h5&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; epoch &lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        z &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; getNoise&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;m&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;realData&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;shape&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; n&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;nGInput&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        fakeData &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Generator&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;predict&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;z&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  
        &lt;span class=&quot;token comment&quot;&gt;# Generator = BuildGenerator()에서 만든 Model(z, Gz)를 활용하여, &lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# &quot;model.predict(z=노이즈 data)&quot; 하라는 뜻 &lt;/span&gt;
        kd &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; KL&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;realData&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; fakeData&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;epoch = %d, D-Loss = %.3f, G-Loss = %.3f, KL divergence = %.3f&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;epoch&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Dloss&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Gloss&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; kd&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# Dloss: 0.6932636 , Gloss: 0.6933405 , kd: 0.2189525518812676 = 분산이 적다&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/br&gt;
&lt;h6 id=&quot;def-kl&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#def-kl&quot; aria-label=&quot;def kl permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;def KL&lt;/h6&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# 두 분포 (P, Q)의 KL divergence를 계산한다.&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;KL&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;P&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Q&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# 두 데이터의 분포를 계산한다&lt;/span&gt;
    histP&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; binsP &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;histogram&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;P&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; bins&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    histQ&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; binsQ &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;histogram&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Q&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; bins&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;binsP&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;token comment&quot;&gt;# 두 분포를 pdf로 만들기 위해 normalization한다.&lt;/span&gt;
    histP &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; histP &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;histP&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1e&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    histQ &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; histQ &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;histQ&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1e&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# KL divergence를 계산한다&lt;/span&gt;
    kld &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;histP &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;log&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;histP &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1e&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;log&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;histQ &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1e&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; kld&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/br&gt;
&lt;/br&gt;
&lt;h4 id=&quot;plt&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#plt&quot; aria-label=&quot;plt permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;plt&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# real data 분포 (p)와 fake data 분포 (q)를 그려본다&lt;/span&gt;
z &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; getNoise&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;m&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;realData&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;shape&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; n&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;nGInput&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
fakeData &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Generator&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;predict&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;z&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

plt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;figure&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;figsize&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
sns&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;set_style&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;whitegrid&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
sns&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;kdeplot&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;realData&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; color&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;blue&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; bw&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0.3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; label&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Real&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
sns&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;kdeplot&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;fakeData&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; color&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;red&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; bw&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0.3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; label&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Fake&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
plt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;legend&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
plt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;title&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Distibution of real and fake data&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
plt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;show&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 487px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/c2ef4c0767c4f98f9747be8c0cb92d40/7b439/image-20200809130155797.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 64.86486486486486%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAABtUlEQVQ4y3VTDbObIBD0///GtvNeGicaH6h8iICwPY5Ikr5Wh1G55W5v9+xijDiO422llPg5jiP6vseXEJimO+7TiGEYeN97z7hEOB8zQqh5OmstB1+TlfUslJBThPkcsNw0Mt3vxQ9o4XC7DphniW7bNsoeWqKycs4teQZwLAryaiB/CWwm0k7mQowhbN4dnDWwlIsZviYsyVpCOlSu9VMQOCMai/mieC89GDK+lKBnOd9prf/fciYWbof8mBFZrwDxU1CssiuYU8fyXta3lk+GMR7MRI0W7ktVFkjQ/QK7+KbliT+N7IwxT8de1sEMQYwkUnGQ9cxw84blulZt47Ojs8Nu3/fm6LsxCVYFrBfJTJsktGwvucA/GZ4a/s2wsFl/zwhqYzbNBHoPYqV9yw4zPj9HqXPOsYZn9eJsOeQ1tfYhqqOl+gujgyTYbxNr+q3l5nIJoI5AucSPO7VcxT8PsKuPghsZtV5qwYqp8cYwB49ArNzqiJmEnVRjd2rUpuAx8OqmYK4S3ngilXjYebBj+R81BUcJMyievT14Zn6KXszjwo/vQLFIv2TcPJww0LrgA/4A4XP6fxf+uRsAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;image-20200809130155797&quot;
        title=&quot;image-20200809130155797&quot;
        src=&quot;/static/c2ef4c0767c4f98f9747be8c0cb92d40/7b439/image-20200809130155797.png&quot;
        srcset=&quot;/static/c2ef4c0767c4f98f9747be8c0cb92d40/12f09/image-20200809130155797.png 148w,
/static/c2ef4c0767c4f98f9747be8c0cb92d40/e4a3f/image-20200809130155797.png 295w,
/static/c2ef4c0767c4f98f9747be8c0cb92d40/7b439/image-20200809130155797.png 487w&quot;
        sizes=&quot;(max-width: 487px) 100vw, 487px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;hr&gt;
&lt;/br&gt;
&lt;/br&gt;
&lt;h2 id=&quot;cnn-gan-dcgan-code&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#cnn-gan-dcgan-code&quot; aria-label=&quot;cnn gan dcgan code permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;CNN GAN (DCGAN) CODE&lt;/h2&gt;
&lt;/br&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;사용한 함수 총 5개:&lt;/br&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;def build&lt;em&gt;generator(inputs, image&lt;/em&gt;size)&lt;/br&gt;&lt;/li&gt;
&lt;li&gt;def build_discriminator(inputs)&lt;/br&gt;&lt;/li&gt;
&lt;li&gt;def train(models, x_train, params)&lt;/br&gt;&lt;/li&gt;
&lt;li&gt;def build&lt;em&gt;and&lt;/em&gt;train&lt;em&gt;models(load&lt;/em&gt;W = False, train_steps = 100)&lt;/br&gt;&lt;/li&gt;
&lt;li&gt;def plot_images():&lt;/br&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/br&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/4867ffac049680dfe4dd33daef7986d9/573d3/image-20200809130207635.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 58.10810810810811%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAABnklEQVQoz3VTS67CMBDrwTkBF+A8bNiwYc8CEC08+qOl/1/m2UNSFSQijRoRx/Z4gic/ljFGDDfDIH1VSVXXUvGL6vv+A7dcnl78VURMk1R5LhmKZF3XaY0QGsfxkxRfb1b6duh+w6XYD8S/3STLMilBWjeNVgviGWtJPQMHhkptJxPaYnsDvgZgFlWropAIhNH9LsH5LOnjAUyjcRi0bxZOPdO2YmgfilUYSRRFkj+f0pMQQCXmOaoDNsZ5Ese6n2iG95t2QWhb7KCUI6c7XKRpKg0EXEZcbI8YCr5eL2ks4fdwdChlWWrgSZLI5XKRMAylQJszITCcLH87nU4qWtupFyBnVLNDtkeCB3K5ISff99UFRZYOSRij1TMyJCFdspM/7HOLV0Jnmy1yio6Q6gNyc4tPxRFSmPG4uxOINE/N0PZOBy1yoTrBJHMgYy/QFc8pSAPD4i3OD/v7H7JarWS73eqeLt0Q6JC5Ubiz72+z2ch6vZb3cx3fDhk0W2XR2W63k+PxqAO6Xq9ajCEIgrl4xswOh4Ps93vd13Yw/zXqn4f5hoHcAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;image-20200809130207635&quot;
        title=&quot;image-20200809130207635&quot;
        src=&quot;/static/4867ffac049680dfe4dd33daef7986d9/fcda8/image-20200809130207635.png&quot;
        srcset=&quot;/static/4867ffac049680dfe4dd33daef7986d9/12f09/image-20200809130207635.png 148w,
/static/4867ffac049680dfe4dd33daef7986d9/e4a3f/image-20200809130207635.png 295w,
/static/4867ffac049680dfe4dd33daef7986d9/fcda8/image-20200809130207635.png 590w,
/static/4867ffac049680dfe4dd33daef7986d9/efc66/image-20200809130207635.png 885w,
/static/4867ffac049680dfe4dd33daef7986d9/c83ae/image-20200809130207635.png 1180w,
/static/4867ffac049680dfe4dd33daef7986d9/573d3/image-20200809130207635.png 1650w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;/br&gt;
&lt;h4 id=&quot;base&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#base&quot; aria-label=&quot;base permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Base&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# load MNIST dataset&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x_train&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; _&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;_&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; _&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; mnist&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;load_data&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot; 비지도 방법으로 사용 &quot;&quot;&quot;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# reshape data for CNN as (28, 28, 1) and normalize &lt;/span&gt;
&lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot; 2D CNN &quot;&quot;&quot;&lt;/span&gt;
image_size &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; x_train&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;shape&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# x_train.shape (60000, 28, 28)&lt;/span&gt;
x_train &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;reshape&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x_train&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; image_size&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; image_size&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# x_train.shape = (60000, 28, 28, 1)&lt;/span&gt;
x_train &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; x_train&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;astype&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;float32&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;255&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# 표준화&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# the latent or z vector is 100-dim&lt;/span&gt;
latent_size &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;#latent: KNN 가기 전 층들&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/br&gt;
&lt;/br&gt;
&lt;h4 id=&quot;step-1-build_generator&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#step-1-build_generator&quot; aria-label=&quot;step 1 build_generator permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;step 1. build_generator&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;build_generator&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;inputs&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; image_size&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# latent 층에 씀 &lt;/span&gt;
    image_resize &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; image_size &lt;span class=&quot;token operator&quot;&gt;//&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;
    
    &lt;span class=&quot;token comment&quot;&gt;# network parameters &lt;/span&gt;
    kernel_size &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;
    layer_filters &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;128&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

    x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Dense&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;image_resize &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; image_resize &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; layer_filters&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;inputs&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Reshape&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;image_resize&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; image_resize&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; layer_filters&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; filters &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; layer_filters&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# hidden 층을 for문으로 써줌(쫙 쌓아주는 것)&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# first two convolution layers use strides = 2&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# the last two use strides = 1&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; filters &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; layer_filters&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            strides &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# 따라서 layer_filters의 뒤에서 2번째까진 strides = 2&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            strides &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
        x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; BatchNormalization&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Activation&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;relu&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Conv2DTranspose&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;filters&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;filters&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                            kernel_size&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;kernel_size&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                            strides&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;strides&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                            padding&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;same&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# data 양 뿔려줌 &lt;/span&gt;

    x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Activation&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;sigmoid&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    generator &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Model&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;inputs&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; x&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; name&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;generator&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# 모방 모델이므로 y 자리엔 x 학습 결과를 써줌 &lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; generator &lt;span class=&quot;token comment&quot;&gt;# 요렇게 fake data 만들어서 전에 모델처럼 Discriminator에 넣어줌 &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/br&gt;
&lt;/br&gt;
&lt;h4 id=&quot;step-2-build_discriminator&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#step-2-build_discriminator&quot; aria-label=&quot;step 2 build_discriminator permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;step 2. build_discriminator&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;build_discriminator&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;inputs&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    kernel_size &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;
    layer_filters &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;128&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

    x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; inputs
    &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; filters &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; layer_filters&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# first 3 convolution layers use strides = 2&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# last one uses strides = 1&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# 따라서 Discriminator를 더 많이 학습하게 됨 &lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; filters &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; layer_filters&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            strides &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            strides &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
        x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; LeakyReLU&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;alpha&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Conv2D&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;filters&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;filters&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                   kernel_size&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;kernel_size&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                   strides&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;strides&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                   padding&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;same&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Flatten&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Dense&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Activation&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;sigmoid&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    discriminator &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Model&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;inputs&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; x&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; name&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;discriminator&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; discriminator&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/br&gt;
&lt;/br&gt;
&lt;h4 id=&quot;step-3-buildandtrain_models&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#step-3-buildandtrain_models&quot; aria-label=&quot;step 3 buildandtrain_models permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;step 3. build&lt;em&gt;and&lt;/em&gt;train_models&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;build_and_train_models&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;load_W &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; train_steps &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    model_name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;dcgan_mnist&quot;&lt;/span&gt;
    
    &lt;span class=&quot;token comment&quot;&gt;# network parameters&lt;/span&gt;
    batch_size &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;64&lt;/span&gt;
    lr &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2e&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;
    decay &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;6e&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt;
    input_shape &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;image_size&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; image_size&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# build discriminator model&lt;/span&gt;
    inputs &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Input&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;shape&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;input_shape&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; name&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;discriminator_input&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    discriminator &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; build_discriminator&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;inputs&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;token comment&quot;&gt;# [1] or original paper uses Adam, &lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# but discriminator converges easily with RMSprop&lt;/span&gt;
    optimizer &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; RMSprop&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;lr&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;lr&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; decay&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;decay&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    discriminator&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;loss&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;binary_crossentropy&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                          optimizer&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;optimizer&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                          metrics&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;accuracy&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    discriminator&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;summary&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;token comment&quot;&gt;# 저장된 discriminator 모델을 읽어온다.&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; load_W&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        discriminator&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;load_weights&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;dataset/dcgan_D.h5&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# build generator model&lt;/span&gt;
    input_shape &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;latent_size&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    inputs &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Input&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;shape&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;input_shape&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; name&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;z_input&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    generator &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; build_generator&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;inputs&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; image_size&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    generator&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;summary&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# 저장된 generator 모델을 읽어온다.&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; load_W&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        generator&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;load_weights&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;dataset/dcgan_G.h5&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        
    &lt;span class=&quot;token comment&quot;&gt;# build adversarial model&lt;/span&gt;
    optimizer &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; RMSprop&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;lr&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;lr &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; decay&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;decay &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;token comment&quot;&gt;# freeze the weights of discriminator during adversarial training&lt;/span&gt;
    discriminator&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;trainable &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;
    
    &lt;span class=&quot;token comment&quot;&gt;# adversarial = generator + discriminator&lt;/span&gt;
    adversarial &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Model&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;inputs&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 
                        discriminator&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;generator&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;inputs&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                        name&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;model_name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    adversarial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;loss&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;binary_crossentropy&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                        optimizer&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;optimizer&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                        metrics&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;accuracy&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    adversarial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;summary&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;#adversarial: 최종모델&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# train discriminator and adversarial networks&lt;/span&gt;
    models &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;generator&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; discriminator&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; adversarial&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    params &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;batch_size&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; latent_size&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; train_steps&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; model_name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    train&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;models&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; x_train&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; params&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;token comment&quot;&gt;# 모델을 저장해 둔다&lt;/span&gt;
    discriminator&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;save_weights&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;dataset/dcgan_D.h5&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    generator&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;save_weights&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;dataset/dcgan_G.h5&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/br&gt;
&lt;/br&gt;
&lt;h4 id=&quot;step-4-train&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#step-4-train&quot; aria-label=&quot;step 4 train permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;step 4. train&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;models&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; x_train&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; params&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# the GAN component models&lt;/span&gt;
    generator&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; discriminator&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; adversarial &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; models 
    
    
    &lt;span class=&quot;token comment&quot;&gt;# network parameters&lt;/span&gt;
    batch_size&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; latent_size&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; train_steps&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; model_name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; params 
    
    
    &lt;span class=&quot;token comment&quot;&gt;# number of elements in train dataset&lt;/span&gt;
    train_size &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; x_train&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;shape&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; i &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;train_steps&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# train the discriminator for 1 batch&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# 1 batch of real (label=1.0) and fake images (label=0.0)&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# randomly pick real images from dataset&lt;/span&gt;
        rand_indexes &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;random&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;randint&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; train_size&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; size&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;batch_size&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        real_images &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; x_train&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;rand_indexes&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
        
        &lt;span class=&quot;token comment&quot;&gt;# generate fake images from noise using generator &lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# generate noise using uniform distribution(모든 확률변수에 대해 균일한 확률을 가짐)&lt;/span&gt;
        noise &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;random&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;uniform&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                                  &lt;span class=&quot;token number&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                                  size&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;batch_size&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; latent_size&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# generate fake images&lt;/span&gt;
        fake_images &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; generator&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;predict&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;noise&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;token comment&quot;&gt;# real + fake images = 1 batch of train data&lt;/span&gt;
        x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;concatenate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;real_images&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; fake_images&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;token comment&quot;&gt;# label real and fake images&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# real images label is 1.0&lt;/span&gt;
        y &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ones&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; batch_size&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;token comment&quot;&gt;# fake images label is 0.0&lt;/span&gt;
        y&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;batch_size&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.0&lt;/span&gt;
        
        &lt;span class=&quot;token comment&quot;&gt;# train discriminator network, log the loss and accuracy&lt;/span&gt;
        loss&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; acc &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; discriminator&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;train_on_batch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 
        &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot;Q. loss: 인덱스??? &quot;&quot;&quot;&lt;/span&gt;
        log &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;%d: [D-loss: %.4f, acc: %.4f]&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; loss&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; acc&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token comment&quot;&gt;# train the adversarial network for 1 batch&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# 1 batch of fake images with label=1.0&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# since the discriminator weights &lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# are frozen in adversarial network(adversarial network: 적대적 신경망(경쟁 속 반대편에 놓인 신경망))&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# only the generator is trained&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# generate noise using uniform distribution&lt;/span&gt;
        noise &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;random&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;uniform&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                                  &lt;span class=&quot;token number&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 
                                  size&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;batch_size&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; latent_size&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;token comment&quot;&gt;# label fake images as real or 1.0&lt;/span&gt;
        y &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ones&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;batch_size&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# train the adversarial network &lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# note that unlike in discriminator training, &lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# we do not save the fake images in a variable&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# the fake images go to the discriminator input of the adversarial&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# for classification&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# log the loss and accuracy&lt;/span&gt;
        loss&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; acc &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; adversarial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;train_on_batch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;noise&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 
        &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot;Q. adversarial 뜻???&quot;&quot;&quot;&lt;/span&gt;
        log &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;%s [G-loss: %.4f, acc: %.4f]&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;log&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; loss&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; acc&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;log&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
   
    &lt;span class=&quot;token comment&quot;&gt;# save the model after training the generator&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# the trained generator can be reloaded for &lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# future MNIST digit generation&lt;/span&gt;
    generator&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;save&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;model_name &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;.h5&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/br&gt;
&lt;/br&gt;
&lt;h4 id=&quot;step-5-fake-data를-화면에-표시&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#step-5-fake-data%EB%A5%BC-%ED%99%94%EB%A9%B4%EC%97%90-%ED%91%9C%EC%8B%9C&quot; aria-label=&quot;step 5 fake data를 화면에 표시 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;step 5. fake data를 화면에 표시&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# Generator가 생성한 이미지(fake data)를 화면에 표시한다.&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;plot_images&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    inputs &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Input&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;shape&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;latent_size&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; name&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;z_input&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    generator &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; build_generator&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;inputs&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; image_size&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    generator&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;load_weights&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;dataset/dcgan_G.h5&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    
    noise_input &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;random&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;uniform&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; size&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; latent_size&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    images &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; generator&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;predict&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;noise_input&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# Generator 통해 나온 fake data&lt;/span&gt;
    plt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;figure&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;figsize&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    num_images &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; images&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;shape&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    
    noise_input &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;random&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;uniform&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; size&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    rows &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sqrt&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;noise_input&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;shape&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; i &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;num_images&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        plt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;subplot&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;rows&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; rows&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        image &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;reshape&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;images&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;image _size&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; image_size&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 
        &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot;why 3차원 reshape???&quot;&quot;&quot;&lt;/span&gt;
        plt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;imshow&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;image&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; cmap&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;gray&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        plt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;axis&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;off&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    plt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;show&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/br&gt;
&lt;/br&gt;
&lt;h4 id=&quot;final&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#final&quot; aria-label=&quot;final permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Final&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# 이미 학습된 weights를 읽어오고, 추가로 학습한다.&lt;/span&gt;
build_and_train_models&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;load_W &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; train_steps &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# train_steps 만큼 반복 학습&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# Generator가 생성한 이미지를 화면에 표시한다.&lt;/span&gt;
plot_images&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/br&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/fa51182f7404b07162d67390997b0e5b/f6b72/image-20200714193936268.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 45.27027027027027%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABe0lEQVQoz5WSW28TMRCF9///Jp5QhVBFKoRACEqTkmUTmna7V9u7vn3MuApQ9amWjsYzts/xGbtCRgiRZXGC5QW8D7RtS9P84tA0WGtZ17WsnaOxDmNMQaXFvu9JKZOF/AXcSE6RlDNJ8mQHkpskl7nUY/D03SPb7Zbj8UjlRLHrelY7MXcnzNBiH/YsY0sY74j1FVFtPO5gPMB0hyzy/yiCAucclVroB1EVpegX4jKTpnvi6Rr34wJXf8Qcv2Nu3mN2l6zbd4T2lhgDmHuYRSCFQqz2K+3POIqtzPNRNknRPEBzRer2pHaH//YGW3/C/dxgr9+W3HsPrmNx0kNl7bpOCPNznHuYEzmGszno9/D7M+wvSfUGf/iCvd0UAac3VN/6KK8a3jz1cRVkEWs+wOkrq9y0SikxSA/1piGEv1GF/uVe7Lhi7SlKffVCEFn1e5kB72xpXVXaJaT6OHpgnucSp2kqUf+WEtd1XWqaK6nuszLXc1b+oUJrfwDgd7kdNL4X5wAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;image-20200714193936268&quot;
        title=&quot;image-20200714193936268&quot;
        src=&quot;/static/fa51182f7404b07162d67390997b0e5b/fcda8/image-20200714193936268.png&quot;
        srcset=&quot;/static/fa51182f7404b07162d67390997b0e5b/12f09/image-20200714193936268.png 148w,
/static/fa51182f7404b07162d67390997b0e5b/e4a3f/image-20200714193936268.png 295w,
/static/fa51182f7404b07162d67390997b0e5b/fcda8/image-20200714193936268.png 590w,
/static/fa51182f7404b07162d67390997b0e5b/f6b72/image-20200714193936268.png 615w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/td&gt;
&lt;td&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/924334ab46f3f70fd22ca0d3fb7204b7/0a47e/image-20200714193941200.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 43.91891891891892%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABoElEQVQoz3WSbY+bMAzH+f6fam/25t5s0m7XHdf2Cm2a0kILJBAICb8ltJWmabNk+SG2Y/vvZBgG/sfWWq7XK1mWIYT4R8y4yK43aK0XPdFKMQPeGnwrcYPCzzPee1zgKL1zf8gne2ZnmaYJ1dbsdjvKsiTp+55IVlU4+RoUvdjMPn7D3zQ/5FRLOrG6+x4NNE1DEtuejGb78wX54wuukcym4SrWtHJ9z+6v4EY63TKHCSJVh5RL+vKo3sWqtG1LYkKH6pyzWae8f//K8XNFfjzxEeztxxvzJcUUG/xlTb5Zcc5TaASHLNjv3xirPUeRh490KKjCDrseGRznQlIWgto4fp0UBymp65o0XfFRtBz2O/I8o1AWcTwgpSA7XXjb7hE3Q61DYwGPJCJTdY5Sj7T9iB4musBm8lg3k1U9ojahqAr+cZmwaAyfF0V4pgkNxJymt2j1GNn5mX6cwmLnZcE8OKIc7cFO1N29WFx+pFINATe/wGQnt8QuoHRdt9zQON5v6na7YYxZ7BgQx7BBj3Hx7XmDcR3PvCirqmIMd/sbQ+20LI/AryoAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;image-20200714193941200&quot;
        title=&quot;image-20200714193941200&quot;
        src=&quot;/static/924334ab46f3f70fd22ca0d3fb7204b7/fcda8/image-20200714193941200.png&quot;
        srcset=&quot;/static/924334ab46f3f70fd22ca0d3fb7204b7/12f09/image-20200714193941200.png 148w,
/static/924334ab46f3f70fd22ca0d3fb7204b7/e4a3f/image-20200714193941200.png 295w,
/static/924334ab46f3f70fd22ca0d3fb7204b7/fcda8/image-20200714193941200.png 590w,
/static/924334ab46f3f70fd22ca0d3fb7204b7/0a47e/image-20200714193941200.png 600w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;</content:encoded></item><item><title><![CDATA[처음 방문했다면 블로그 소개를]]></title><description><![CDATA[안녕하세요. 이곳엔 다양한 포스팅이 올라옵니다. 태그로 동일 관심분야를 검색해주세요. 안하면 모를테고, 하면 늘겠지 싶은 마음으로 일단 파고들었던 모든 것들을 이곳에 올릴 예정입니다. 이런 것까지...?  이런 것까지... 올라올 거예요.]]></description><link>https://jynee.github.io/tags#1st/main/</link><guid isPermaLink="false">https://jynee.github.io/tags#1st/main/</guid><pubDate>Sun, 02 Aug 2020 00:00:00 GMT</pubDate><content:encoded>&lt;br&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;JyneeEarth git blog&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;batch&quot;&gt;&lt;pre class=&quot;language-batch&quot;&gt;&lt;code class=&quot;language-batch&quot;&gt;&lt;span class=&quot;token command&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;ML&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token command&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;DL&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token command&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;NLP&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token command&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;Contents&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token command&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;Japanese&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token command&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;etc&lt;/span&gt; &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;br&gt;
&lt;p&gt;안녕하세요.&lt;/p&gt;
&lt;p&gt;이곳엔 다양한 포스팅이 올라옵니다.&lt;/p&gt;
&lt;h1 id=&quot;태그로-동일-관심분야를-검색해주세요&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%83%9C%EA%B7%B8%EB%A1%9C-%EB%8F%99%EC%9D%BC-%EA%B4%80%EC%8B%AC%EB%B6%84%EC%95%BC%EB%A5%BC-%EA%B2%80%EC%83%89%ED%95%B4%EC%A3%BC%EC%84%B8%EC%9A%94&quot; aria-label=&quot;태그로 동일 관심분야를 검색해주세요 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;태그로 동일 관심분야를 검색해주세요.&lt;/h1&gt;
&lt;br&gt;
&lt;br&gt;
&lt;blockquote&gt;
&lt;p&gt;안하면 모를테고, 하면 늘겠지&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;싶은 마음으로 일단 파고들었던 모든 것들을 이곳에 올릴 예정입니다.&lt;/p&gt;
&lt;br&gt;
&lt;p&gt;&lt;em&gt;이런 것까지...?&lt;/em&gt; &lt;/p&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
&lt;p&gt;이런 것까지... 올라올 거예요.&lt;/p&gt;
&lt;br&gt;</content:encoded></item><item><title><![CDATA[TQT(The question I asked the teacher today)]]></title><description><![CDATA[pre-training & fine-tuning  설명 pre-training Weight와 Bias를 초기화 시키는 방법 fine-tuning…]]></description><link>https://jynee.github.io/tags#1st/TQT(The question I asked the teacher today.)/</link><guid isPermaLink="false">https://jynee.github.io/tags#1st/TQT(The question I asked the teacher today.)/</guid><pubDate>Sat, 01 Aug 2020 00:00:00 GMT</pubDate><content:encoded>&lt;h1 id=&quot;pre-training--fine-tuning&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#pre-training--fine-tuning&quot; aria-label=&quot;pre training  fine tuning permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;pre-training &amp;#x26; fine-tuning&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;설명&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;pre-training&lt;/td&gt;
&lt;td&gt;Weight와 Bias를 초기화 시키는 방법&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;fine-tuning&lt;/td&gt;
&lt;td&gt;기존에 학습되어져 있는 모델을 기반으로 아키텍쳐를 새로운 목적(나의 이미지 데이터에 맞게)변형하고 이미 학습된 모델 Weights로 부터 학습을 업데이트하는 방법&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;출처: 꾸준희. 2017.08.17. &quot;[Deep Learning] pre-training 과 fine-tuning (파인튜닝)&quot;. &lt;a href=&quot;https://eehoeskrap.tistory.com/186&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://eehoeskrap.tistory.com/186&lt;/a&gt;. Enough is not enough&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;wweights&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#wweights&quot; aria-label=&quot;wweights permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;W(weights)&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;네트워크 및 model build까지 완성해서 실행되어 역전파 되었을 때 형성된다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;compile에서 w&lt;/code&gt;: 네트워크 만들고 난 후 model build하는 과정. optimizer &amp;#x26; loss 값을 정의해주는 부분임. w는 만들어져있지 않다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;fit에서 w&lt;/code&gt;: fit은 train data 사용. A 다음 B가 &lt;strong&gt;나온다고 저장&lt;/strong&gt; &lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;predict에서 w&lt;/code&gt;: predict(예측)는 test data 사용. 예측 모델 기준으로 A를 넣으면 B가 &lt;strong&gt;나오게 하는&lt;/strong&gt; 어떤 것(Thing)&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;hyper-parameter&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#hyper-parameter&quot; aria-label=&quot;hyper parameter permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Hyper parameter&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;weight decay&lt;/code&gt;(annealing): epoch(alpha)를 처음에는 적당히 높게 했다가, 점차 줄여 나가는 방법&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;dense&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#dense&quot; aria-label=&quot;dense permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Dense&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Dense&lt;/code&gt;: fully connected&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;ANN(FNN)&lt;/code&gt;에서는 여러 &lt;code class=&quot;language-text&quot;&gt;Dense&lt;/code&gt;를 써도 되지만, &lt;code class=&quot;language-text&quot;&gt;RNN(LSTM)&lt;/code&gt;에선 마지막 층에서만 &lt;code class=&quot;language-text&quot;&gt;Dense&lt;/code&gt;를 써야함.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;CNN&lt;/code&gt;에서는 여러 &lt;code class=&quot;language-text&quot;&gt;Dense&lt;/code&gt; 써도 될까?&lt;/li&gt;
&lt;li&gt;=&gt; 일단... &lt;code class=&quot;language-text&quot;&gt;lstm&lt;/code&gt;에서 &lt;code class=&quot;language-text&quot;&gt;lstm() → Dense → lstm()&lt;/code&gt;은 &lt;code class=&quot;language-text&quot;&gt;lstm 네트워크가 2개&lt;/code&gt; 만들어진다고 보면 된다. &lt;code class=&quot;language-text&quot;&gt;lstm() → Dense&lt;/code&gt; 했을 때, &lt;code class=&quot;language-text&quot;&gt;1개의 네트워크&lt;/code&gt;가 형성된 것&lt;/li&gt;
&lt;li&gt;=&gt; 그리고 &lt;code class=&quot;language-text&quot;&gt;CNN&lt;/code&gt;은 일종의 잘 짜여진 레시피라서 &lt;code class=&quot;language-text&quot;&gt;con1D → pooling → Dense → con1D → pooling&lt;/code&gt;은 위 &lt;code class=&quot;language-text&quot;&gt;lstm&lt;/code&gt;처럼 좀 이상한 네트워크 구조가 되는 거라 생각함...&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Dense(1, activation=&apos;sigmoid&apos;)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;LSTM에서 FNN으로 보내는 마지막 Dense에선 relu 쓰면 안됨&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;fnn순방향-신경망&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#fnn%EC%88%9C%EB%B0%A9%ED%96%A5-%EC%8B%A0%EA%B2%BD%EB%A7%9D&quot; aria-label=&quot;fnn순방향 신경망 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;FNN(순방향 신경망)&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;↔ RNN&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;hidden 층에서&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Dense(4, &lt;code class=&quot;language-text&quot;&gt;activation&lt;/code&gt; = &apos;sigmoid&apos;, &lt;code class=&quot;language-text&quot;&gt;kernel_regularizer&lt;/code&gt;=regularizers.l2(0.0001), activation=&apos;relu&apos;)&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Dropout&lt;/code&gt;(rate=0.5)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;BatchNormalization&lt;/code&gt;(momentum=0.9, epsilon=0.005, center=True, scale=True, moving&lt;em&gt;variance&lt;/em&gt;initializer=&apos;ones&apos;)&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;predict&lt;/code&gt;까지 끝낸 &lt;strong&gt;연속형&lt;/strong&gt; &lt;code class=&quot;language-text&quot;&gt;yHat&lt;/code&gt; 값을, &lt;code class=&quot;language-text&quot;&gt;np.where&lt;/code&gt; 써줘서 &lt;strong&gt;바이너리 형태&lt;/strong&gt;로 변환 &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;where&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;yHat &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# 딥러닝_파일: 4-4.ANN(Credit_Keras)_직접 해보기_커스텀loss.py&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;history&lt;/code&gt; 활용&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;hist&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;history&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;loss&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
hist&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;history&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;val_loss&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# 딥러닝_파일: 4-4.ANN(Credit_Keras)_직접 해보기.py&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;학습/평가/예측용 model로 나누었을 때 &lt;strong&gt;평가 데이터 활용&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;fit&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;trainX&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; trainY&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; validation_data&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;evlX&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; evlY&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; epochs&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; batch_size&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;lstm&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#lstm&quot; aria-label=&quot;lstm permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;LSTM&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;long term(장기기억, 전체적 흐름), short term(단기기억, 최근의 흐름)&lt;/li&gt;
&lt;li&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;설명&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;2층&lt;/td&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;lstm()&lt;/code&gt;을 2번 써준다&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;양방향&lt;/td&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;bidirectional&lt;/code&gt; + &lt;code class=&quot;language-text&quot;&gt;merge_mode = ‘concat’&lt;/code&gt; &lt;br /&gt;FNN, BFN 값을 merge_mode 형태로 합쳐서 list형으로 되돌려줌&lt;br /&gt;단방향(FBN)은 ‘이후’만 기억, 양방향(FBN+BFN)은 ‘이전’+’이후’ 모두 기억&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;many-to-many&lt;/td&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;return-sequences = True&lt;/code&gt;&lt;br /&gt;LSTM 뉴런 &lt;strong&gt;각각의 중간 스텝에서 나오는 각각의 출력(h)&lt;/strong&gt;을 (바로 위 뉴런으로도) 사용(전파)한다는 뜻&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;timedistributed&lt;/td&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;timedistributed()&lt;/code&gt;&lt;br /&gt; &lt;strong&gt;FFN으로 가기 전&lt;/strong&gt; LSTM 마지막 층에서 각 뉴런의 각 지점에서 계산한 오류를 다음 층으로 전파&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;LSTM이 many-to-many 상태에서 FNN으로 가면 각각의 Output 값이 나온다&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;NLP의 챗봇, 기계번역 등에서 사용함.&lt;/li&gt;
&lt;li&gt;Input &gt; 안녕 만나서 반가워&lt;/li&gt;
&lt;li&gt;Output &gt; 저도 반갑습니다&lt;/li&gt;
&lt;li&gt;3개의 출력층. 비어 있는 1개는 padding &lt;/li&gt;
&lt;li&gt;Q. ... padding은 어디로?&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;LSTM에서 사용되는 h와 c&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;역할&lt;/th&gt;
&lt;th&gt;특징&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;h&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;위, 왼쪽&lt;/strong&gt; 전파&lt;/td&gt;
&lt;td&gt;LSTM이 1층일 땐 c랑 똑같이 왼쪽으로 밖에 전파 못한다.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;c&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;왼쪽&lt;/strong&gt; 전파&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;h와 c 둘다 처음엔 0으로 시작한다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;cnn&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#cnn&quot; aria-label=&quot;cnn permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;CNN&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;이미지를 대표할 수 있는 특성들을 도출해서 FNN에 넣어줌&lt;/li&gt;
&lt;li&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;code&lt;/th&gt;
&lt;th&gt;설명&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;Input&lt;/code&gt;(batch_shape = (None, nStep, nFeature, nChannel))&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;Conv2D&lt;/code&gt;(filters=30, kernel_size=(8,3), strides=1, padding = &apos;same&apos;, activation=&apos;relu&apos;)&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;MaxPooling2D&lt;/code&gt;(pool_size=(2,1), strides=1, padding=&apos;valid&apos;)&lt;/td&gt;
&lt;td&gt;- 경우에 따라 conv2D, pooling 더 써줄 수 있음&lt;br /&gt;- &lt;code class=&quot;language-text&quot;&gt;GlobalMaxPooling1D()&lt;/code&gt;도 있음&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;Flatten()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;2D는 4차원이라 shape 맞추려고 보통 flatten을 써줌&lt;br /&gt;1d는 안 써도 되는 듯(?)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;Dense&lt;/code&gt;(nOutput, activation=&apos;linear&apos;)&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;lstm과-cnn의-차이&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#lstm%EA%B3%BC-cnn%EC%9D%98-%EC%B0%A8%EC%9D%B4&quot; aria-label=&quot;lstm과 cnn의 차이 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;LSTM과 CNN의 차이&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;둘다 (흐름을 보는)시계열 데이터에 사용할 수 있다.&lt;/li&gt;
&lt;li&gt;LSTM과 CNN1D는 기능은 비슷하지만 CNN1D는 table 中 &lt;strong&gt;(colum 전체+n row)아래 방향으로의 흐름&lt;/strong&gt;을 보는 거고, &lt;/li&gt;
&lt;li&gt;LSTM은 bidirectional 을 사용해서 table 中 &lt;strong&gt;위/아래로 흐름&lt;/strong&gt;을 이동시켜서 볼 수 있다.&lt;/li&gt;
&lt;li&gt;CNN2D는 kernel_size, pooling 등을 통해 tabel 中 &lt;strong&gt;(n colum(일부분) + n row(일부분) = 내가 focus를 맞춰 보고 싶은 부분)에 따라 그 흐름을 볼 수 있다는 데&lt;/strong&gt;서 차이가 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/05265afca2b82133a555e66d16254a73/108f8/image-20200805122723206.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 63.51351351351351%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAABmUlEQVQ4y5WTW1ODMBCF+///W1860xkdb22tCpYCuZMQOO4GUlHbBxmYwMnm25PNshpB1zjS/feZpv6nrxIM168c9B99lR2azxPa93eIokBzPMILkYLsqULz9gbJOo2ubpIelELz9Az58Ij29RW6mfQJOMQk+nONUUooApuqSgHySBBKxrotPyE/iqSbooR6fkG8u4cvy2TmG6gryLrCMAyTK2PgOk/OeyjRIoSQdO89NM3RBGxbJ/fQGlFpyLZdAD0LNWIGWgvrOnLuoUj3ob8AlSbgGGElAedEkUomaQcLoCFgswCaGRgI2BAw/ASCgIKAzk3Avv8FDDZZjjFO9aFt2Y6A0UG3Z4R+0nnrOgEpqTjDcVI+AjLyE6hOEFVxaR/n5i33BuL0kd65JbgUeaEp96m+2XlzOWWmDFR8KSi7TovqukbXTdn5EFpyz3oeE8SZFCeovRj27XBuUra93W6x2+3+dP9+v8dms0lOcmx2tl6vcTgcFo3Ni+bF7Cq3yBLKOjvLoKzzN0N7OpSsra79SsvvW3O39C+NMPfX+fR5GQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;image-20200805122723206&quot;
        title=&quot;image-20200805122723206&quot;
        src=&quot;/static/05265afca2b82133a555e66d16254a73/fcda8/image-20200805122723206.png&quot;
        srcset=&quot;/static/05265afca2b82133a555e66d16254a73/12f09/image-20200805122723206.png 148w,
/static/05265afca2b82133a555e66d16254a73/e4a3f/image-20200805122723206.png 295w,
/static/05265afca2b82133a555e66d16254a73/fcda8/image-20200805122723206.png 590w,
/static/05265afca2b82133a555e66d16254a73/108f8/image-20200805122723206.png 777w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;h1 id=&quot;activation&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#activation&quot; aria-label=&quot;activation permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;activation&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;activation(비선형 함수)&lt;/th&gt;
&lt;th&gt;loss&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;softmax&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;sparse_categorical_crossentropy&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;sigmoid&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;binary_crossentropy&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;linear&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;mse&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;relu&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;← Hidden layer에 씀. 기울기가 0이기 때문에 뉴런이 죽을 수 있는 단점 有&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Leakly ReLU&lt;/td&gt;
&lt;td&gt;뉴런이 죽을 수 있는 현상 해결&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;PReLU&lt;/td&gt;
&lt;td&gt;x&amp;#x3C;0 에서 학습 가능&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;granger causality&lt;/td&gt;
&lt;td&gt;통제된 상황에서 인과관계가 가능하다고 말할 수 있음. 시계열 데이터에서 쓰일 수 있음&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;sparse&lt;em&gt;categorical&lt;/em&gt;crossentropy&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;model &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Model&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;encoderX&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; decoderX&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; outputY&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;optimizer&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;optimizers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Adam&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;lr&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0.001&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; loss&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;sparse_categorical_crossentropy&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;sparse 안 쓸 거면 위에 &apos;outputY&apos;를 to&lt;em&gt;categorical()로 변형 후, loss 함수로 &quot;categorical&lt;/em&gt;crossentropy&quot; 사용&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;target이 one-hot encoding되어 있으면 categorical&lt;em&gt;crossentropy,
target이 integer로 되어 있으면 sparse&lt;/em&gt;categorical&lt;em&gt;crossentropy를 쓴다.
sparse&lt;/em&gt;categorical&lt;em&gt;entropy는 integer인 target을 one-hot으로 바꾼 후에 categorical&lt;/em&gt;entropy를 수행한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;딥러닝 네트워크(DN)의 노드는 입력값을 전부 더한 후, 활성화 함수(Activation function)를 통과시켜 다음 노드에 전달한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;이때 사용하는 활성화 함수는 비선형 함수를 쓴다. &lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;softmax---sigmoid&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#softmax---sigmoid&quot; aria-label=&quot;softmax   sigmoid permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;softmax - sigmoid&lt;/h2&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;구분&lt;/th&gt;
&lt;th&gt;함수&lt;/th&gt;
&lt;th&gt;code&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;회귀&lt;/td&gt;
&lt;td&gt;항등함수(출력값을 그대로 반환)&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;분류(0/1)&lt;/td&gt;
&lt;td&gt;sigmoid&lt;/td&gt;
&lt;td&gt;# 시험 데이터로 학습 성능을 평가한다&lt;br/&gt;predicted = model.predict(test&lt;em&gt;input)&lt;br/&gt;test&lt;/em&gt;pred = np.where(predicted &gt; 0.5, 1, 0)&lt;br/&gt;accuracy = (test&lt;em&gt;label == test&lt;/em&gt;pred).mean()&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;분류(multiple)&lt;/td&gt;
&lt;td&gt;softmax&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt; Cross-Entropy : 예측한 값과 실제값의 차를 계산. entropy 값이 감소하는 방향으로 진행하다 보면 최저 값을 찾을 수 있다. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;출처: sshkim Sh.TK. 2017. 8. 23. &quot;[모두의딥러닝] Softmax Regression (Multinomial Logistic Regression)&quot;. &quot;&lt;a href=&quot;https://sshkim.tistory.com/146&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://sshkim.tistory.com/146&lt;/a&gt;&quot;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt; argmax 을 사용하면 2라는 값이 나온다. 가장 큰 값의 위치가 2번째에 있는 1이기 때문&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;출처: JINSOL KIM. 2017. 12. 24. &quot;Softmax vs Sigmoid&quot;. &lt;a href=&quot;https://blog.naver.com/infoefficien/221170205067&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://blog.naver.com/infoefficien/221170205067&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;relu&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#relu&quot; aria-label=&quot;relu permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;ReLu&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;히든층에 자주 쓰임&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;그냥 CNN이든 LSTM이든 출력층 Dense에 Relu 쓰지 말자&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;LSTM에선 Relu 안 쓰는 게 좋음. 특히 출력층엔 쓰면 안 됨.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h1 id=&quot;학습compile-예측predict&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%95%99%EC%8A%B5compile-%EC%98%88%EC%B8%A1predict&quot; aria-label=&quot;학습compile 예측predict permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;학습(compile), 예측(predict)&lt;/h1&gt;
&lt;h2 id=&quot;optimizer&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#optimizer&quot; aria-label=&quot;optimizer permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;optimizer&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;종류(빈도순)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;adam&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Adadelta, RMSprop, Adagrad&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;momentum&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;GD, NAG&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;li&gt;최적화가 잘 안 되면 글로벌 minmun을 찾지 못하고 로컬 minimum에 빠진다. 이때 로컬 minimum을 &lt;strong&gt;어떻게 빨리&lt;/strong&gt; 탈출할 수 있을지 U턴 메소드를 쓸지, 다른 1차 미분방법(GD)를 쓸 지 결정하게 된다. &lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;epoch&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#epoch&quot; aria-label=&quot;epoch permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;epoch&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;epoch&lt;/code&gt; 수치가 커지면 &lt;code class=&quot;language-text&quot;&gt;optimizer&lt;/code&gt;가 일을 해서 local이 아닌 global을 찾아간다.&lt;/li&gt;
&lt;li&gt;그런데 너무 크면 overfitting&lt;/li&gt;
&lt;li&gt;따라서 적당한 &lt;code class=&quot;language-text&quot;&gt;epoch&lt;/code&gt; 설정이 필요 &lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;batch_size&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#batch_size&quot; aria-label=&quot;batch_size permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Batch_size&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;data가 크면 &lt;code class=&quot;language-text&quot;&gt;batch_size&lt;/code&gt;도 크게&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;25,000개의 raw data라면 &lt;code class=&quot;language-text&quot;&gt;batch_size&lt;/code&gt; = 20 보다 300 이 정도로 설정&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h1 id=&quot;nlp--dl&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#nlp--dl&quot; aria-label=&quot;nlp  dl permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;NLP &amp;#x26; DL&lt;/h1&gt;
&lt;h2 id=&quot;sgns&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#sgns&quot; aria-label=&quot;sgns permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;SGNS&lt;/h2&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;용어&lt;/th&gt;
&lt;th&gt;설명&lt;/th&gt;
&lt;th&gt;CODE&lt;/th&gt;
&lt;th&gt;참고&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;pre-trained&lt;/td&gt;
&lt;td&gt;SGNS에서 학습한 We를 적용&lt;/td&gt;
&lt;td&gt;model.layers[1]&lt;strong&gt;.set_weights&lt;/strong&gt;(We)&lt;/td&gt;
&lt;td&gt;해당 code 적용 후 model fit 진행&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;fine-training&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;SGNS에 모델 학습(fit) 시, 학습을 따로 시키는 이유?&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# 학습&lt;/span&gt;
hist &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;fit&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;X&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; X&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; X&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 
               batch_size&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;BATCH_SIZE&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
               epochs&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;NUM_EPOCHS&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;각기 연결된 가중치 선이 구분되어 있기 때문에&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;SGNS 모델 만들 때 dot을 한다면, &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;axis=2&lt;/strong&gt;    &lt;em&gt;@2&lt;/em&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt; → 후에&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;reshape&lt;strong&gt;(())&lt;/strong&gt;    &lt;em&gt;@괄호 두 개&lt;/em&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;SGNS로 만든 Embedding의 w(가중치)를 basic한 word data에 적용할 때, load_weights 사용하는 방법도 있다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;근데 이땐 shape을 맞춰줘야 한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;w &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; encoder&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;load_weights&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;model_w.h5&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# 가중치(w) 불러온 후,&lt;/span&gt;
emb &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Embedding&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;max_features&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; embedding_dims&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; load_weights &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; w&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;xInput&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# embedding layer에 바로 적용&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;보통 이런 느낌으로 씀&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;weights &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; load_weights&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
embedding_layer &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Embedding&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;input_dim&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;V&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                            output_dim&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;embedding_dim&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                            input_length&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;input_length&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                            trainable&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                            weights&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;weights&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                            name&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;embedding&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;embedding--pad_sequences&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#embedding--pad_sequences&quot; aria-label=&quot;embedding  pad_sequences permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Embedding &amp;#x26; pad_sequences&lt;/h2&gt;
&lt;h3 id=&quot;word2vec-기준&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#word2vec-%EA%B8%B0%EC%A4%80&quot; aria-label=&quot;word2vec 기준 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;word2vec 기준&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;word2vec&lt;/th&gt;
&lt;th&gt;code&lt;/th&gt;
&lt;th&gt;input&lt;/th&gt;
&lt;th&gt;output&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;tokenizer&lt;/td&gt;
&lt;td&gt;tokenizer = Tokenizer()&lt;br /&gt;tokenizer.fit&lt;em&gt;on&lt;/em&gt;texts(clean&lt;em&gt;train&lt;/em&gt;review)&lt;br /&gt;train&lt;em&gt;sequences = tokenizer.texts&lt;/em&gt;to&lt;em&gt;sequences(clean&lt;/em&gt;train_review)&lt;/td&gt;
&lt;td&gt;[안녕, 만나서, 반가워]&lt;/td&gt;
&lt;td&gt;[13, 4, 3]&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;pad_sequences&lt;/td&gt;
&lt;td&gt;train&lt;em&gt;inputs = pad&lt;/em&gt;sequences(train&lt;em&gt;sequences, maxlen=MAX&lt;/em&gt;SEQUENCE_LENGTH, padding=&apos;post&apos;)&lt;/td&gt;
&lt;td&gt;[13, 4, 3]&lt;/td&gt;
&lt;td&gt;([0,0...1,..],[0,0,0,1,0,...],[0,0,1,...])&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Embedding&lt;/td&gt;
&lt;td&gt;embedding&lt;em&gt;layer = Embedding(input&lt;/em&gt;dim=VOCAB&lt;em&gt;SIZE, output&lt;/em&gt;dim=EMB_SIZE)&lt;/td&gt;
&lt;td&gt;([0,0...1,..],[0,0,0,1,0,...],[0,0,1,...])&lt;/td&gt;
&lt;td&gt;[0,0...1,..] -&gt; ANN layer&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;embedding&lt;em&gt;layer 는 결국 pad&lt;/em&gt;sequence된 단어들끼리 모임. 즉, 1개 문장에 대한 임베딩 행렬이 됨 &lt;/p&gt;
&lt;p&gt;1개 단어 = 1개 임베딩 레이어=벡터값&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;doc2vec-기준&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#doc2vec-%EA%B8%B0%EC%A4%80&quot; aria-label=&quot;doc2vec 기준 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;doc2vec 기준&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;doc2vec&lt;/th&gt;
&lt;th&gt;code&lt;/th&gt;
&lt;th&gt;input&lt;/th&gt;
&lt;th&gt;output&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;TaggedDocument&lt;/td&gt;
&lt;td&gt;documents = [TaggedDocument(doc, [i]) for i, doc in enumerate(sentences)]&lt;/td&gt;
&lt;td&gt;[...,&apos;laughabl&apos;, &apos;horror&apos;], ...]&lt;/td&gt;
&lt;td&gt;TaggedDocument(words=[&apos;move&apos;, &apos;last&apos;, ... &apos;horror&apos;], tags=[999])&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Embedding&lt;/td&gt;
&lt;td&gt;model = Doc2Vec(vector&lt;em&gt;size=300, alpha=0.025, min&lt;/em&gt;alpha=0.00025, min_count=10, workers=4, dm =1)&lt;/td&gt;
&lt;td&gt;TaggedDocument(words=[&apos;move&apos;, &apos;last&apos;, ... &apos;horror&apos;], tags=[999])&lt;/td&gt;
&lt;td&gt;[벡터값]&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;tags=[999] : 999번 째 문장&lt;/p&gt;
&lt;p&gt;Embedding은 model.build_vocab, model.train 거치면 한 문장에 대한 하나의 벡터가 나온다.&lt;/p&gt;
&lt;p&gt;(word2vec의 경우 한 문장에 있는 각각의 단어 수만큼 벡터가 나온다.)&lt;/p&gt;
&lt;p&gt;1개 문장 = 1개 임베딩 레이어 = 1개 벡터값&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h1 id=&quot;chatbot&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#chatbot&quot; aria-label=&quot;chatbot permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;ChatBot&lt;/h1&gt;
&lt;h2 id=&quot;sequence-to-sequence&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#sequence-to-sequence&quot; aria-label=&quot;sequence to sequence permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Sequence to Sequence&lt;/h2&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;encoder&lt;/th&gt;
&lt;th&gt;decoder&lt;/th&gt;
&lt;th&gt;가능/불가능&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;1층&lt;/td&gt;
&lt;td&gt;2층&lt;/td&gt;
&lt;td&gt;&lt;em&gt;불가능&lt;/em&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1층&lt;/td&gt;
&lt;td&gt;1층&lt;/td&gt;
&lt;td&gt;가능&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2층&lt;/td&gt;
&lt;td&gt;1층&lt;/td&gt;
&lt;td&gt;가능&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2층&lt;/td&gt;
&lt;td&gt;2층&lt;/td&gt;
&lt;td&gt;가능&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;&quot;굳이 2층으로 할 필요가 있는가?&quot;&lt;/p&gt;
&lt;p&gt;→ 1층으로 하는 건 선형의 개념. 2층은 비선형의 개념이다.&lt;/p&gt;
&lt;p&gt;비선형이 분류를 더 잘해낼 수도 있지만, overfitting의 위험이 있다. &lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h1 id=&quot;기타&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B8%B0%ED%83%80&quot; aria-label=&quot;기타 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;기타&lt;/h1&gt;
&lt;h2 id=&quot;유클리디안-거리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9C%A0%ED%81%B4%EB%A6%AC%EB%94%94%EC%95%88-%EA%B1%B0%EB%A6%AC&quot; aria-label=&quot;유클리디안 거리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;유클리디안 거리&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;거리 계산할 때, 비교하고 싶은 건 &lt;code class=&quot;language-text&quot;&gt;[]&lt;/code&gt;를 쳐서 넣어주기  &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;euclidean_distances&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;father&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; mother&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;가중치-저장save&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B0%80%EC%A4%91%EC%B9%98-%EC%A0%80%EC%9E%A5save&quot; aria-label=&quot;가중치 저장save permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;가중치 저장(Save)&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Embedding (left side) layer의 W를 저장할 때, [2]를 저장한단 사실 알아두기&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;data/embedding_W.pickle&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;wb&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; f&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  pickle&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;dump&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;layers&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get_weights&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; f&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; pickle&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;HIGHEST_PROTOCOL&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;영역별-code--논문-참고하기-좋은-site&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%98%81%EC%97%AD%EB%B3%84-code--%EB%85%BC%EB%AC%B8-%EC%B0%B8%EA%B3%A0%ED%95%98%EA%B8%B0-%EC%A2%8B%EC%9D%80-site&quot; aria-label=&quot;영역별 code  논문 참고하기 좋은 site permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;영역별 code &amp;#x26; 논문 참고하기 좋은 site&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;SOTA site&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://paperswithcode.com/sota&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://paperswithcode.com/sota&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[딥러닝 LSTM&CNN]]></title><description><![CDATA[딥러닝 DL RNN CNN 순환 신경망(RNN) hidden 층에서 서로 값을 기억해 순환한다. 지금까진 FNN(feed forward neword) + 순서가 필요 없는 data를 써서 모델이 기억할 필요가 없었지만, 문장 같은 data…]]></description><link>https://jynee.github.io/tags#1st/딥러닝_2/</link><guid isPermaLink="false">https://jynee.github.io/tags#1st/딥러닝_2/</guid><pubDate>Tue, 14 Jul 2020 00:00:00 GMT</pubDate><content:encoded>&lt;h1 id=&quot;딥러닝-dl&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%94%A5%EB%9F%AC%EB%8B%9D-dl&quot; aria-label=&quot;딥러닝 dl permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;딥러닝 DL&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;RNN&lt;/li&gt;
&lt;li&gt;CNN&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;
&lt;br&gt;
&lt;h2 id=&quot;순환-신경망rnn&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%88%9C%ED%99%98-%EC%8B%A0%EA%B2%BD%EB%A7%9Drnn&quot; aria-label=&quot;순환 신경망rnn permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;순환 신경망(RNN)&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;hidden 층에서 서로 값을 기억해 순환한다.&lt;/li&gt;
&lt;li&gt;지금까진 FNN(feed forward neword) + 순서가 필요 없는 data를 써서 모델이 기억할 필요가 없었지만, 문장 같은 data를 쓸 땐 &lt;strong&gt;순서가 중요한 data(Sequence Data)를 가지고 미래를 예측해야 한다.&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;학습(트레이닝) 방법: 순서가 있는 data를 모델이 ‘기억’하게 만드는 것&lt;/li&gt;
&lt;li&gt;RNN 기본 입력은 3d 형태. D1=time, d2=feature, d0=data&lt;/li&gt;
&lt;li&gt;RNN 문제점: 기울기 소실 문제(vanishing gradient)가 FFN보다 더 심해짐&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;
&lt;br&gt;
&lt;h3 id=&quot;lstm&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#lstm&quot; aria-label=&quot;lstm permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;LSTM&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;RNN의 vanishing gradient 해결을 위해 고안. C 추가&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;f와 i의 가중평균 형태&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;batch&quot;&gt;&lt;pre class=&quot;language-batch&quot;&gt;&lt;code class=&quot;language-batch&quot;&gt;&lt;span class=&quot;token command&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;f&lt;/span&gt;: forget date. 이전의 C를 얼마나 반영할 것인지 조절&lt;/span&gt;
&lt;span class=&quot;token command&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;i&lt;/span&gt;: input or ignore. 현재 입력값(x&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;과 이전의 출력값&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token command&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;h&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;를 얼마나 반영할 것인지 조절

* h는 위, 왼쪽 / c는 왼쪽으로 전파. 둘다 처음엔 0으로 시작함&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;GRU: LSTM 구조를 간결하게 만듦. 속도도 더 빠르지만 성능도 안 떨어짐 &lt;/li&gt;
&lt;li&gt;
&lt;p&gt;학습 유형: 단방향(FNN,BFN) / 양방향(FNN+BFN) 모두 적용 가능.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 572px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/1fd151e537c9dbae72645f58985cffd3/a805e/image-20200816004535796.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 31.08108108108108%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAABTklEQVQY0yWRic7aMBCEef9Xq0T+ltAAIYdz2jkIgRAgB1/X1JJljz2amd3dlGVJGMVM05umbTmdA+JYYZcxWu4x2pgvfr1epGnCOQhJ0oxlXRmf4xfbbaqKTdMNhHkv9A9x0eMcG/ZBy3uamN4v+tuDc3plnmcew4PbfcQNLvwIL9VXEXyyO1/47bfk1Y1N23WovBC9D7mp8MTJV4kknmkuNWmRooqSZV6oGkOhc46R4m8QUUlFTxH8jyVh09iENYmJbEBxSNiFW47JnmVZCAsf5/RL/kM+60fePf6EjpwubuSg24JxHDkI3sc/X7zpxaVSilWKbrOUWmuufS8JJ6o4Ijt41IliFoMyCMgFGxVzkcqGYWB8DBT+idzz6GwP+7qmjSIbkM4SZQC2L9M8Ufs+meN8/1dh6MOBbLulEWzF7JDG+x3tupS7HZ0M+B8z5r8n/iUOUQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;image-20200816004535796&quot;
        title=&quot;image-20200816004535796&quot;
        src=&quot;/static/1fd151e537c9dbae72645f58985cffd3/a805e/image-20200816004535796.png&quot;
        srcset=&quot;/static/1fd151e537c9dbae72645f58985cffd3/12f09/image-20200816004535796.png 148w,
/static/1fd151e537c9dbae72645f58985cffd3/e4a3f/image-20200816004535796.png 295w,
/static/1fd151e537c9dbae72645f58985cffd3/a805e/image-20200816004535796.png 572w&quot;
        sizes=&quot;(max-width: 572px) 100vw, 572px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Many to one: 둘다 정보량이 TIME이 증가할수록 높아진다. 따라서 높은 정보량끼리 마지막에 합친다&lt;/li&gt;
&lt;li&gt;Many to many&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;FNN 정보량이 TIME이 증가할수록 높아진다. &lt;/p&gt;
&lt;p&gt;BFN 정보량이 TIME이 증가할수록 낮아진다.&lt;/p&gt;
&lt;p&gt;따라서 각 뉴런에서 latent layer로 이어지는 정보량(마지막에 FNN정보량+BFN정보량)은 같다&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;One to many&lt;/li&gt;
&lt;li&gt;Many to many&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;단방향은 ‘이후’만 기억, 양방향은 ‘이전’+’이후’ 모두 기억&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;어떻게? 단방향은 FBN만 사용, 양방향은 FBN+BFN 사용하기 떄문.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;양방향(FNN+BFN) 진행 순서: &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;모델(code)에서(RNN층 내) FNN 진행 후 정보량 모아두고, &lt;/li&gt;
&lt;li&gt;BFN 진행 후 정보량 모아두고,&lt;/li&gt;
&lt;li&gt;CONCAT(합침)해서 &lt;/li&gt;
&lt;li&gt;error를 역전파 시킴 &lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;FNN VS BFN:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;FNN : TIME이 낮-&gt;높&lt;/li&gt;
&lt;li&gt;BFN : TIME이 높-&gt;낮&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;
&lt;br&gt;
&lt;h2 id=&quot;cnn&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#cnn&quot; aria-label=&quot;cnn permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;CNN&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;사람의 시각인지 과정을 모방해서 피드포워드 신경망에 추가&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;이미지를 분류한다 치면, 이미지의 부분적 특성에 주목해 분류하여 FFN에 넣는 것 &lt;/li&gt;
&lt;li&gt;
&lt;p&gt;이미지 분석에 활용: 이미지를 대표할 수 있는 특성들을 도출해서 신경망에 넣어준다.&lt;/p&gt;
&lt;br&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;순서 &lt;/p&gt;
&lt;p&gt;특성 추출 → 클래스 분류
→ &lt;strong&gt;컨볼루션&lt;/strong&gt; 또는 필터링 과정
→ &lt;strong&gt;특성지도&lt;/strong&gt; 출력
→ 서브샘플링(subsampling) 또는 &lt;strong&gt;풀링&lt;/strong&gt;(pooling)
→ 다시 컨볼루션, 활성화, 서브샘플링을 수행
→ 최종 특성지도는 피드포워드 신경망에 입력되어 분류 작업을 시행&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;batch&quot;&gt;&lt;pre class=&quot;language-batch&quot;&gt;&lt;code class=&quot;language-batch&quot;&gt;컨볼루션: 
&lt;span class=&quot;token command&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;image&lt;/span&gt; data의 경우&lt;/span&gt;
→ filter&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token command&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;kernel&lt;/span&gt;: image data와의 convolution(cross-correlation&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 진행&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 
→ feature map 생성&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;기호에 따라 zero padding, ReLU와 같은 활성함수 적용 가능&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
→ &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token command&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;token parameter attr-name&quot;&gt;/mean&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; pooling 
→ feature map 생성&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;출력&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 
→ flatten&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;: 1D구조로 만듦&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 
→ FNN&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;
&lt;ol&gt;
&lt;li&gt;입력된 이미지로부터 이미지의 고유한 특징을 부각시킨 특성지도(feature map)를 새로 만듦&lt;/li&gt;
&lt;li&gt;그 이미지는 피드포워드 신경망에 입력되어 이미지가 어떤 클래스 라벨에 속하는지 분류&lt;/li&gt;
&lt;li&gt;학습: (grid serch) 수평 엣지 필터, 수직 엣지 필터 컨볼루션&lt;/li&gt;
&lt;li&gt;ReLU와 같은 활성함수를 거쳐 특성지도 출력&lt;/li&gt;
&lt;li&gt;서브샘플링(subsampling) 또는 풀링(pooling) 통해 활성화된 특성지도들의 크기를 줄임&lt;/li&gt;
&lt;li&gt;(저차원적인 특성부터 시작해서 고차원적인 특성을 도출)이 특성지도들에 다시 컨볼루션, 활성화, 서브샘플링을 수행하여 로컬한 특성지도로부터 글로벌한 특성지도를 만들어간다.&lt;/li&gt;
&lt;li&gt;이 과정을 여러번 반복하여 얻어진 최종 특성지도는 fully-connected layer, 즉 피드포워드 신경망에 입력되어 분류 작업을 시행&lt;/li&gt;
&lt;/ol&gt;
&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;용어&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;feature map&lt;/code&gt;: 이미지의 부분적 특징을 모아놓은 것의 집합&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;padding&lt;/code&gt;:&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;convolution layer&lt;/code&gt;: convolution(cross-correlation) 진행되는 곳 &lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;upsampling&lt;/code&gt;: pooling layer와 달리 차원을 줄이는 게 아니라 차원을 늘림. Autoencoder의 decoder와 같은 곳에서 원래 데이터로 복원할 때 사용됨. Zero padding은 가생이를 0으로 채우는데 sampling은 무슨 계산을 해서 채우는 듯하다.  &lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;
&lt;h3 id=&quot;코딩-용어-설명&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%BD%94%EB%94%A9-%EC%9A%A9%EC%96%B4-%EC%84%A4%EB%AA%85&quot; aria-label=&quot;코딩 용어 설명 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;코딩 용어 설명&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;컨볼루션 레이어 단계&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Filters&lt;/code&gt;: 출력 모양의 깊이(depth) 를 결정&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;kernel_size&lt;/code&gt;: &lt;/li&gt;
&lt;li&gt;w(연결선, 가중치)이자, filter의 size.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;연산을 수행할 때 윈도우의 크기&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;2D에서 kernel_size=(8,1)이면 8행+1열(이때 1열은 feature)&lt;/li&gt;
&lt;li&gt;1D에서 kernel_sizw=8이면 자동 8행+전체열(1D에서 필터는 아래 방향으로 밖에 이동 못함)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;strides&lt;/code&gt;: 필터 적용 시 한 번에 얼마나 움직일지(이동 크기) 이동할 칸 수. 보통 1을 씀. &lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;padding&lt;/code&gt;:
컨볼루션 레이어(합성곱) 혹은 풀링 연산을 수행하는 레이어에 파라미터로 설정
convolution과 pooling 연산은 파라미터의 수를 줄여나가는 과정이다. 하지만 이러한 과정에서 지나치게 데이터가 축소되어 정보가 소실되는 것을 방지하기 위해 데이터에 0으로 이루어진 패딩을 주는 경우가 있다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;padding = &amp;#39;same&amp;#39;&lt;/code&gt;: 원본 사이즈 유지시킴(차원 유지)&lt;/li&gt;
&lt;li&gt;원리: 필터의 사이즈가 k이면 사방으로 k/2 만큼의 패딩을 준다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;padding = &amp;#39;valid&amp;#39;&lt;/code&gt;: 패딩 사용하지 않음 &lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;activation: ‘ReLu’&lt;/code&gt;가 default. CNN에선 ReLu 사용을 권장한다고 함 &lt;/li&gt;
&lt;/ul&gt;
 &lt;br&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;pooling&lt;/code&gt; 단계&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;원본이미지에서 특징 추출해서 feature map의 크기를 줄여주는 과정. &lt;/li&gt;
&lt;li&gt;(1) Max pooling, (2) mean pooling이 있음 &lt;/li&gt;
&lt;li&gt;pool&lt;em&gt;size: strides가 미리 설정되지 않을 경우 pool&lt;/em&gt;size와 동일하게 설정된다. &lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;strides&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;padding:  ‘원본’(사이즈)을 조정. filter를 거치면 이미지 사이즈가 원본과 달리 작아지는데, 이를 피하기 위해 작아지는 사이즈가 원본 사이즈만큼 되도록 원본 사이즈 크기를 늘림. 이때, Zero padding 기법을 사용. 수치(?)가 없는 부분 즉, 가생이(모서리)을 ‘0’으로 채움(가생이 아니고 중간 부분 채워도 zero-padding)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;fatten&lt;/code&gt; 단계&lt;/li&gt;
&lt;li&gt;Flatten&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;output&lt;/code&gt; 단계&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Dense(n, activation = )&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
 &lt;br&gt;
 &lt;br&gt;
&lt;h2 id=&quot;차원-참고&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%B0%A8%EC%9B%90-%EC%B0%B8%EA%B3%A0&quot; aria-label=&quot;차원 참고 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;차원 참고&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;1차원 벡터: shape(2,)&lt;/li&gt;
&lt;li&gt;2차원 Matrix : shape(행,열)&lt;/li&gt;
&lt;li&gt;3차원: shape(면, 행, 열) = D0, D1, D2&lt;/li&gt;
&lt;li&gt;4차원: shape (samples, rows, cols, channels) = D0, D1, D2 ,D3 &lt;/li&gt;
&lt;/ul&gt;
 &lt;br&gt;
&lt;br&gt;
 &lt;br&gt;
&lt;blockquote&gt;
&lt;p&gt;참고: &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;아마퀀트. 2019. 7. 19. &quot;Keras LSTM** 유형 정리 (2/5) – 단층-단방향 &amp;#x26; many-to-many 유형&quot;. &lt;a href=&quot;http://blog.naver.com/chunjein/221589624838&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;http://blog.naver.com/chunjein/221589624838&lt;/a&gt;. 아마추어 퀀트 (Amateur Quant).&lt;/li&gt;
&lt;li&gt;chrisysl. 2018. 9. 10. &quot;3. Convolutional Networks / L2. Convolutional Neural Networks - Convolutional Layers in Keras&quot;. &lt;a href=&quot;https://kevinthegrey.tistory.com/141&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://kevinthegrey.tistory.com/141&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;심교훈. 2019. 3. 1. &quot;딥러닝 알고리즘의 대세, 컨볼루션 신경망(convolutional neural network, CNN)&quot;. &lt;a href=&quot;https://bskyvision.com/412?category=635506b&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://bskyvision.com/412?category=635506b&lt;/a&gt;. 스카이비전&lt;/li&gt;
&lt;li&gt;Seongyun Byeon. 2018.01.23. 딥러닝에서 사용되는 여러 유형의 Convolution 소개&quot;. &lt;a href=&quot;https://zzsza.github.io/data/2018/02/23/introduction-convolution/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://zzsza.github.io/data/2018/02/23/introduction-convolution/&lt;/a&gt;. 어쩐지 오늘은&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;</content:encoded></item><item><title><![CDATA[딥러닝 기초]]></title><description><![CDATA[딥러닝 DL optimaizer kerass optimizers 이차방정식 계수 추정 방법들: : 움직임  : 미분해서 움직임 : 지수이동평균법으로 움직임 : 관성 방향으로 이동 후 그 지점에서 GD 방향으로 움직임  가중치(알파 or lr…]]></description><link>https://jynee.github.io/tags#1st/딥러닝_1/</link><guid isPermaLink="false">https://jynee.github.io/tags#1st/딥러닝_1/</guid><pubDate>Fri, 03 Jul 2020 00:00:00 GMT</pubDate><content:encoded>&lt;h1 id=&quot;딥러닝-dl&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%94%A5%EB%9F%AC%EB%8B%9D-dl&quot; aria-label=&quot;딥러닝 dl permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;딥러닝 DL&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;optimaizer&lt;/li&gt;
&lt;li&gt;kerass&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;optimizers&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#optimizers&quot; aria-label=&quot;optimizers permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;optimizers&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;이차방정식 계수 추정 방법들:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;SGD&lt;/code&gt;: 움직임&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;GD&lt;/code&gt; : 미분해서 움직임&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;momentum&lt;/code&gt;: 지수이동평균법으로 움직임&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;NAG&lt;/code&gt;: 관성 방향으로 이동 후 그 지점에서 GD 방향으로 움직임 &lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;가중치(알파 or lr) 조정 알고리즘&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Adagrad&lt;/code&gt;: 업데이트 多~작은 알파 / 업데이트 小~큰 알파&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;RMSprop&lt;/code&gt;: Adagrad에서 반복할수록 과도하게 작아진다는 알파값 보완 &lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Adadelta&lt;/code&gt;: RMSprop와 같은데 알파값이 자동조절됨&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Adam&lt;/code&gt;: RMSprop + momentum&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;keras&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#keras&quot; aria-label=&quot;keras permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Keras&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Sequential 모델: &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;From tensorflow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;keras&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;layes &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Dense
From tensorflow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;keras&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;models &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Sequential
Model &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Sequential&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;#그래프 생성(모델 생성)&lt;/span&gt;
Model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;add&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Dense&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; input_dim &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;#layer(dense), 노드 1개, 그 노드에 2개가 들어온다고 알려줌&lt;/span&gt;
Model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;complile&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;loss&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;’mse’&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; optimizer&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;optimizers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Adam&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;lr&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0.05&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
Model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;fit&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;dataX&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; epochs &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;300&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;#학습&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;더 간단한 모델: &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;From tensorflow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;keras&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;layes &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Input&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Dense
From tensorflow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;keras&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;models &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Model
xInput &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Input&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;batch_shape&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;#그래프 생성(모델 생성)&lt;/span&gt;
yInput &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Dense&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;xInput&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
model &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Model&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;xInput&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; yOutput&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;#xinput 들어가서 yinput나오는 model&lt;/span&gt;
model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;complie&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;loss&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;’mse’&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; optimizer&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;optimizers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Adam&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;lr&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0.05&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;fit&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;dataX&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;y&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;epochs&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;300&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;#학습&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;잔차 계산 방법들:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Stochastic GD update: 그때그때 error 계산, a, b, c 업데이트&lt;/li&gt;
&lt;li&gt;Batch update: 한꺼번에 error 계산하고 a, b , c 업뎃&lt;/li&gt;
&lt;li&gt;Mini-batch update: 일부 error 계산하고 그때마다 a, b, c 를 업데이트. Stochastic GD update, Batch update의 중간 특성&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Model 의 기본적인 code:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;.fit&lt;/code&gt; : train data를 만들어둔 model로 학습시킴&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;.predict&lt;/code&gt;: test data를 만들어둔 model로 궁예해봄&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[머신러닝 분석 방법들, 두 번째]]></title><description><![CDATA[머신러닝(ML) K-Means 클러스터링 H-clustering DBSAN 앙상블 연관규칙 분석 k-means 클러스터링 비지도학습 비계층적 군집분석 k-means 클러스터링은 데이터를 k개의 클러스터(cluster…]]></description><link>https://jynee.github.io/tags#1st/머신러닝_2/</link><guid isPermaLink="false">https://jynee.github.io/tags#1st/머신러닝_2/</guid><pubDate>Tue, 30 Jun 2020 00:00:00 GMT</pubDate><content:encoded>&lt;h1 id=&quot;머신러닝ml&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A8%B8%EC%8B%A0%EB%9F%AC%EB%8B%9Dml&quot; aria-label=&quot;머신러닝ml permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;머신러닝(ML)&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;K-Means 클러스터링&lt;/li&gt;
&lt;li&gt;H-clustering&lt;/li&gt;
&lt;li&gt;DBSAN&lt;/li&gt;
&lt;li&gt;앙상블&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;연관규칙 분석&lt;/p&gt;
&lt;br&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;
&lt;h2 id=&quot;k-means-클러스터링&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#k-means-%ED%81%B4%EB%9F%AC%EC%8A%A4%ED%84%B0%EB%A7%81&quot; aria-label=&quot;k means 클러스터링 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;strong&gt;k-means&lt;/strong&gt; 클러스터링&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;Grid search&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 
    Init &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; ‘k&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;means&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;’
    n_init&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;
    max_iter&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;300&lt;/span&gt;
    tol&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;le&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;04&lt;/span&gt;
    random_state&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;비지도학습&lt;/li&gt;
&lt;li&gt;비계층적 군집분석&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;k-means 클러스터링은 데이터를 k개의 클러스터(cluster, 무리)로 분류&lt;/p&gt;
&lt;br&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;EM알고리즘&lt;/code&gt;: 중점을 할당한 후, 각 중점까지의 거리의 합을 최소화하는 알고리즘&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;알고리즘(작동 원리):&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;사용자로부터 입력받은 k의 값에 따라, 임의로 클러스터 중심(centroid) k개를 설정해준다.&lt;/li&gt;
&lt;li&gt;k개의 클러스터 중심으로부터 모든 데이터가 얼마나 떨어져 있는지 계산한 후에, 가장 가까운 클러스터 중심을 각 데이터의 클러스터로 정해준다. &lt;/li&gt;
&lt;li&gt;각 클러스터에 속하는 데이터들의 &lt;strong&gt;평균&lt;/strong&gt;을 계산함으로 클러스터 중심을 &lt;strong&gt;옮겨준다&lt;/strong&gt;. &lt;/li&gt;
&lt;li&gt;보정된 클러스터 중심을 기준으로 2, 3단계를 반복한다.&lt;/li&gt;
&lt;li&gt;더이상 클러스터 중심이 이동하지 않으면 알고리즘을 종료한다. &lt;/li&gt;
&lt;/ol&gt;
 &lt;br&gt;
&lt;/li&gt;
&lt;li&gt;new data 입력(발생) 시엔 각 중점과의 거리만 비교해서 가장 가까운 곳에 있는 군집에 속한다고 파악&lt;/li&gt;
&lt;li&gt;초기값에 따라 전역이 아닌 지역 최소 값을 찾을 수 있음&lt;/li&gt;
&lt;li&gt;r에 따라 {0,1} 이면 명목형, 확률이면 연속형(GMM 모델)&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;적합한 k 개수를 찾고 검증하는 모델들&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;k-means-elbow-method&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#k-means-elbow-method&quot; aria-label=&quot;k means elbow method permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;K-Means Elbow Method&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;“k는 얼마가 적합할까?” 적합한 k개수 찾는 성격인 듯하다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Grid search: &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;n_clusters 조절&lt;/li&gt;
&lt;li&gt;error: 군집 속 중점과의 거리의 합 &amp;#x3C;- 이라고 개념을 설정해두고(왜냐면 k-means는 비지도학습이라 정답이 없어서 label이나 target, class 등이 없어서 확인 못함) 군집화가 잘 된 경우라면 error가 작을 것.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;따라서 k가 증가할 때 줄어드는 ‘폭’이 작아지는 지점의 k값이 최적 군집 개수&lt;/li&gt;
&lt;li&gt;거리의 합 != 거리가 줄어드는 폭.&lt;/li&gt;
&lt;li&gt;엘보우는 거리가 줄어드는 폭을 봄&lt;/li&gt;
&lt;/ul&gt;
 &lt;br&gt;
&lt;h3 id=&quot;실루엣silhouette&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%8B%A4%EB%A3%A8%EC%97%A3silhouette&quot; aria-label=&quot;실루엣silhouette permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;실루엣(Silhouette)&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;“군집화가 잘 됐나?” &amp;#x3C;- 약간 검증하는 성격인 듯하다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;잘 된 군집화: &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;군집 간 거리(b) &gt; 군집 내 거리(a) &lt;/li&gt;
&lt;li&gt;cohesion(응집도:군집 내) &amp;#x3C; separation(분리도:군집 간) &lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;실루엣 계수는 원형 군집이 아닌 경우 잘 맞지 않음&lt;/li&gt;
&lt;li&gt;0~1값을 가짐&lt;/li&gt;
&lt;/ul&gt;
 &lt;br&gt;
&lt;h2 id=&quot;k-means군집clustering&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#k-means%EA%B5%B0%EC%A7%91clustering&quot; aria-label=&quot;k means군집clustering permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;K-Means++군집(clustering)&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;local optimum 해결 위해 초기 중점을 좀 더 합리적으로 설정하는 방법&lt;/li&gt;
&lt;/ul&gt;
 &lt;br&gt;
 &lt;br&gt;
&lt;hr&gt;
&lt;br&gt;
&lt;br&gt;
&lt;h2 id=&quot;h-clustering&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#h-clustering&quot; aria-label=&quot;h clustering permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;H-clustering&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;계층적 군집분석&lt;/li&gt;
&lt;li&gt;덴드로그램&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;k-menas 와의 차이점:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;k-means는 &lt;strong&gt;사전에 그룹수(k)&lt;/strong&gt; 결정, &lt;/li&gt;
&lt;li&gt;H-clutering은 한 개의 그룹이 남을 때까지 &lt;strong&gt;그룹을 다 나눈 후&lt;/strong&gt; 몇 개 선택할지 두 개의 feature를 갖는 2차원의 덴드로그램으로 결정&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;
 &lt;br&gt;
&lt;hr&gt;
&lt;br&gt;
&lt;br&gt;
&lt;h2 id=&quot;dbscan&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#dbscan&quot; aria-label=&quot;dbscan permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;DBSCAN&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;Grid search&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    eps &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.2&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# 앱실론: 특정 ‘반경’&lt;/span&gt;
    min_samples&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# 0.2 반경에 샘플 5개가 있어야 함&lt;/span&gt;
    metric &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; ‘euclidean’&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;계층적 군집분석&lt;/li&gt;
&lt;li&gt;밀집도 기반의 군집 알고리즘: core point(핵심 샘플), border point(경계 샘플), noise point(잡음 샘플)&lt;/li&gt;
&lt;li&gt;noise point는 분류하지 않는다&lt;/li&gt;
&lt;li&gt;K-means or 다른 군집분석과의 차이점: 모든 샘플을 클러스터에 할당하지 않고 잡음 샘플을 구분하는 능력이 있다&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;
&lt;br&gt;
&lt;hr&gt;
&lt;br&gt;
&lt;br&gt;
&lt;h2 id=&quot;앙상블-기법&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%95%99%EC%83%81%EB%B8%94-%EA%B8%B0%EB%B2%95&quot; aria-label=&quot;앙상블 기법 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;앙상블 기법&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;다수의 결과를 예측하여 종합하고 분류함&lt;/li&gt;
&lt;li&gt;여러 알고리즘을 사용한 후 결과를 종합하여 정확도, 일반화 특성을 증가시킴&lt;/li&gt;
&lt;li&gt;classification_report(~~)&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;
&lt;h3 id=&quot;배깅bagging-or-bootstrap-aggregation&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%B0%B0%EA%B9%85bagging-or-bootstrap-aggregation&quot; aria-label=&quot;배깅bagging or bootstrap aggregation permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;배깅(Bagging or Bootstrap Aggregation)&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;BaggingClassifier&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; Hyper parameter &lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    base_estimatior &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; m
    n_estimators &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;
    bootstrap &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; prob &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; bag&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;predict_proba&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;testX&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; predY &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;argmax&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;prob&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; axis&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# axis=1 하는 이유: 안 하면 하나의 값인 int가 나와서 밑에 testY랑 mean하려면 array 형태로 나와야 함&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; accuracy &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;testY &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; predY&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;mean&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;BootStrap(단순복원 임의추출)을 통해 샘플 뽑아내 서브 데이터 만듦&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;각각의 서브 데이터 크기 = 원본 훈련 데이터 크기 &lt;/li&gt;
&lt;li&gt;why? 데이터 중복 허용해서 분산(변동)이 감소하고 overfitting 방지&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
 &lt;br&gt;
&lt;h3 id=&quot;부스팅boosting-증폭-가속&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%B6%80%EC%8A%A4%ED%8C%85boosting-%EC%A6%9D%ED%8F%AD-%EA%B0%80%EC%86%8D&quot; aria-label=&quot;부스팅boosting 증폭 가속 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;부스팅(Boosting): 증폭, 가속.&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;잘못 분류된 데이터에 가중치 두어 다시 뽑고 다시 분류하는 알고리즘&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;서브 훈련 샘플 만듦&lt;/li&gt;
&lt;li&gt;처음 샘플링은 가중치를 두어 샘플링함 -&gt; 분류 잘못된 데이터는 가중치 높이고 다시 샘플링. 이때 잘못 분류된 패턴이 선택될 확률이 높음. &lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt; → 분류가 어려운 패턴에 더욱 집중하여 정확도를 높이는 방법&lt;/p&gt;
 &lt;br&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;adaboostadaptive-boosting&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#adaboostadaptive-boosting&quot; aria-label=&quot;adaboostadaptive boosting permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;AdaBoost(Adaptive Boosting)&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;약한 분류기&lt;/strong&gt; 사용. 잘못 분류한 데이터 샘플에 가중치를 두어 더 많이 샘플링하여 정확도 높임&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;서브 데이터로만 만듦(잔차 등으로 만드는 거 아님)&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;AdaBoostClassifier&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
Hyper parameter&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  base_estimator&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;svm
  n_estimators&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;#100번 재조합한단 뜻(오분류한 거에 가중치둬서)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;
&lt;h4 id=&quot;gradient-boostingfor-regression&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#gradient-boostingfor-regression&quot; aria-label=&quot;gradient boostingfor regression permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Gradient Boosting(for regression)&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;target 데이터의 &lt;strong&gt;잔차&lt;/strong&gt;를 줄이도록 학습. 학습할수록 residual(잔차)가 계속 작아짐. 잔차가 더 이상 줄어들지 않을 떄까지 tree 생성하며 학습+추정치 업데이트&lt;/li&gt;
&lt;li&gt;residual 계산법 : 변수-(평균+학습률(알파. 0~1사이 값. 아무렇게나 줘도 됨. 보통 0.1)*tree의 leaf 평균&lt;/li&gt;
&lt;li&gt;선형회귀라 dataset도 연속형 변수인 boston 집값을 보도록 한다.&lt;/li&gt;
&lt;li&gt;선형회귀라 MSE 대신 r2 사용해도 OK&lt;/li&gt;
&lt;li&gt;MSE: 선형, 로지스틱 회귀 둘다 쓰여도 OK. 다만 선형에선 R2를, 로지스틱에선 BCE(바이너리일 떄) 더 잘 쓰임..(?)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;GradientBoostingRegressor&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
Hyper parameter&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    Loss &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; ‘ls’           	&lt;span class=&quot;token comment&quot;&gt;# lest square = MSE 사용&lt;/span&gt;
    Learning_rate &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.1&lt;/span&gt;     &lt;span class=&quot;token comment&quot;&gt;# 알파. 가중치&lt;/span&gt;
    n_estimators &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;      &lt;span class=&quot;token comment&quot;&gt;# 잔차(tree) 100개 만들라&lt;/span&gt;
    max_depth&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; 			&lt;span class=&quot;token comment&quot;&gt;# 얕은 depth&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;br&gt;
&lt;h4 id=&quot;gradient-boostingfor-classification&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#gradient-boostingfor-classification&quot; aria-label=&quot;gradient boostingfor classification permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Gradient Boosting(for classification)&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Regression과 동일하나, 추정치를 위해 odds, logs(odds), probability 개념 사용&lt;/li&gt;
&lt;li&gt;binary cross entropy(BCE)를 loss함수로 사용&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;GradientBoostingClassifier&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
Hyper parameter&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    loss &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; ‘devianve’&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;      &lt;span class=&quot;token comment&quot;&gt;#로지스틱 함수 + CE 쓰라는 뜻&lt;/span&gt;
    learning_rate &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;     &lt;span class=&quot;token comment&quot;&gt;#학습률, 가중치, 알파값&lt;/span&gt;
    n_estimators&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;      &lt;span class=&quot;token comment&quot;&gt;#잔차(tree) 수&lt;/span&gt;
    max_depth&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;br&gt;
&lt;h4 id=&quot;xgboostextreme-gradient-boostingfor-regression&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#xgboostextreme-gradient-boostingfor-regression&quot; aria-label=&quot;xgboostextreme gradient boostingfor regression permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;XGBoost(Extreme Gradient Boosting)(for regression)&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;정규화와 가지치기를 통해 &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;overfitting을 줄이고 &lt;/li&gt;
&lt;li&gt;일반화 특성을 좋게 만듦&lt;/li&gt;
&lt;li&gt;특히 대용량 data의 경우에 속도도 SOSO&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;Similarity, output 값 사용: Similarity를 사용해서 잔차와 IG 계산하고 마지막에 output 계산해서 마지막 잔차 계산&lt;/li&gt;
&lt;li&gt;데이터 大 ~ similarity(유사도) 小 why? 상쇄되는 값이 많아서.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;py&quot;&gt;&lt;pre class=&quot;language-py&quot;&gt;&lt;code class=&quot;language-py&quot;&gt;XGBRegressor&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
Hyper parameter&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 
	Objective &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;’reg&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;squarederror’     &lt;span class=&quot;token comment&quot;&gt;#regression 사용하고 MSE 사용한단 뜻. regression이니 r2 사용&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;br&gt;
&lt;h4 id=&quot;xgboostextreme-gradient-boostingfor-classification&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#xgboostextreme-gradient-boostingfor-classification&quot; aria-label=&quot;xgboostextreme gradient boostingfor classification permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;strong&gt;XGBoost(Extreme Gradient Boosting)(for classification)&lt;/strong&gt;&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;잔차 계산 시, output value를 사용한다는 데서 Gradient Boost랑 차이가 있음&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;Hyper parameter&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;chapter &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; XGBClassifier&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; Objective &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;’binary&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;logistic’        &lt;span class=&quot;token comment&quot;&gt;#바이너리 변수고 logistic함수(sigmoid) 사용&lt;/span&gt;
    
&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;chapter &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; XGBClassifier&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; Param – &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;‘eta’ &lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 
  ‘max_depth’ &lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 
  ‘objective’ &lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ‘multi&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;softprob’      &lt;span class=&quot;token comment&quot;&gt;#softmas 사용한단 뜻&lt;/span&gt;
  ‘num_class’ &lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;            		  &lt;span class=&quot;token comment&quot;&gt;#클래스 개수&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;br&gt;
&lt;h3 id=&quot;랜덤포레스트random-forest&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%9E%9C%EB%8D%A4%ED%8F%AC%EB%A0%88%EC%8A%A4%ED%8A%B8random-forest&quot; aria-label=&quot;랜덤포레스트random forest permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;랜덤포레스트(Random Forest)&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;RandomForestClassifier&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
Hyper parameter&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    max_depth&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;
    estimaors&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;DT(Decision Tree)를 앙상블함 &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;트리마다 서로 다른 feature 사용&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;샘플링 함&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;
&lt;h3 id=&quot;다수결-알고리즘majority-voting&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%8B%A4%EC%88%98%EA%B2%B0-%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98majority-voting&quot; aria-label=&quot;다수결 알고리즘majority voting permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;다수결 알고리즘(Majority Voting)&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;배깅/부스팅과의 차이점: 학습데이터를 서브data에 sampling 하느냐/안 하느냐&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;다수결 알고리즘은 배깅/부스팅처럼 서브데이터로 나눈 게 아니라 그 자체를 쓴다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;
&lt;h3 id=&quot;isolation-forestiforest&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#isolation-forestiforest&quot; aria-label=&quot;isolation forestiforest permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Isolation Forest(iForest):&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;Model &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; IsolationForest
Hyper parameter&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    n_estimators &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;   &lt;span class=&quot;token comment&quot;&gt;#100개의 트리&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;이상데이터 검출하는 알고리즘 (ex: 카드 불법 사용에 사용)&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Keyword: &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;이진검색트리&lt;/li&gt;
&lt;li&gt;Anomaly score(이상치 수치)&lt;/li&gt;
&lt;li&gt;recall, precison 사용&lt;/li&gt;
&lt;li&gt;특히 recall 써서 실제 정상(T)인데 비정상(F)으로 예측했다던가, 실제 비정상(F)인데 정상(T)로 예측한 비율 찾아냄&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
 &lt;br&gt;
 &lt;br&gt;
&lt;hr&gt;
&lt;br&gt;
&lt;br&gt;
&lt;h2 id=&quot;연관규칙-분석&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%97%B0%EA%B4%80%EA%B7%9C%EC%B9%99-%EB%B6%84%EC%84%9D&quot; aria-label=&quot;연관규칙 분석 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;연관규칙 분석&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;장바구니 분석. 고객들의 구매 성향을 분석할 수 있음&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;지지도: y가 독립변수인지 종속변수인지 불명확함&lt;/li&gt;
&lt;li&gt;신뢰도: y에 대한 영향을 무시한단 단점이 있음&lt;/li&gt;
&lt;li&gt;향상도: 1에 가까우면 X와 Y는 서로 독립적. 1보다 크면 양의 상관성, 1보다 작으면 음의 상관성. 리프트가 1보다 클수록 X→Y 규칙의 의미가 커짐&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;지지도/신뢰도/향상도 특징:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;인과관계가 아닌 상관관계&lt;/li&gt;
&lt;li&gt;얼마나 빈번하게 나타나는지 측정&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;이진행렬 구성&lt;/li&gt;
&lt;li&gt;지/신/향 모두 임계치 이상인 모든 규칙을 찾기엔 Brute Force 방식을 써서 조합이 너무 많아짐. 따라서 이 조합을 줄일 수 있는 알고리즘이 Apriori 알고리즘.&lt;/li&gt;
&lt;li&gt;항목을 줄이는 게 관건&lt;/li&gt;
&lt;li&gt;한 항목 집합이 반발하면, 그것의 모든 부분 집합이 반발한단 뜻에서 지지도 기반 가지치기&lt;/li&gt;
&lt;li&gt;연관성이 높다 = lift가 높다&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;Hyper parameter&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    Frequent_itemsets &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; apriori&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;df&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; min_support &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.6&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; use_columname&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# Item sparse matrix생성&lt;/span&gt;
    rules &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; association_rules&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;frequent_itemsets&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; metric&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;”lift”&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; min_threshold&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0.7&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# 모델 생성&lt;/span&gt;
    Rules &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; association_rules&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;by&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;‘lift&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;’&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; axis &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; ascendin&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# Lift가 작은 것부터 sort&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;blockquote&gt;
&lt;p&gt;참고: 심교훈. 2019. 10. 9. “가장 간단한 군집 알고리즘, k-means 클러스터링&quot;. &lt;a href=&quot;https://bskyvision.com/564&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://bskyvision.com/564&lt;/a&gt;. b스카이비전&lt;/p&gt;
&lt;/blockquote&gt;</content:encoded></item><item><title><![CDATA[머신러닝 분석 방법들, 첫 번째]]></title><description><![CDATA[머신러닝(ML) KNN Decision Tree SVM 선형회귀분석 로지스틱회귀분석 나이브베이지안  차원(feature…]]></description><link>https://jynee.github.io/tags#1st/머신러닝_1/</link><guid isPermaLink="false">https://jynee.github.io/tags#1st/머신러닝_1/</guid><pubDate>Tue, 23 Jun 2020 00:00:00 GMT</pubDate><content:encoded>&lt;h1 id=&quot;머신러닝ml&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A8%B8%EC%8B%A0%EB%9F%AC%EB%8B%9Dml&quot; aria-label=&quot;머신러닝ml permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;머신러닝(ML)&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;KNN&lt;/li&gt;
&lt;li&gt;Decision Tree&lt;/li&gt;
&lt;li&gt;SVM&lt;/li&gt;
&lt;li&gt;선형회귀분석&lt;/li&gt;
&lt;li&gt;로지스틱회귀분석&lt;/li&gt;
&lt;li&gt;나이브베이지안&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;
&lt;br&gt;
&lt;h2 id=&quot;code-classlanguage-text차원의-저주code&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#code-classlanguage-text%EC%B0%A8%EC%9B%90%EC%9D%98-%EC%A0%80%EC%A3%BCcode&quot; aria-label=&quot;code classlanguage text차원의 저주code permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;strong&gt;&lt;code class=&quot;language-text&quot;&gt;차원의 저주&lt;/code&gt;&lt;/strong&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;차원(feature)이 증가하면 성능이 저하된다&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;차원이 증가할수록 말 그대로 ‘근접 이웃’에 한정하기 어려워 멀리 떨어진 데이터를 참조한다&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;→ 따라서 데이터 양에 비해 feature의 수가 많으면 차원의 저주 문제를 생각해봐야 한다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;차원의 저주를 벗어날 수 있는 방법:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;차원 축소(feature 축소)&lt;/li&gt;
&lt;li&gt;데이터 양을 늘림&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;차원의 저주를 벗어날 수 있는 모델&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;중요도 분석&lt;/code&gt;(의사결정나무 – 사전 가지치기)&lt;/li&gt;
&lt;li&gt;PCA 주성분 분석&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;
&lt;br&gt;
&lt;h2 id=&quot;code-classlanguage-textknnk-nearest-neighborcode&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#code-classlanguage-textknnk-nearest-neighborcode&quot; aria-label=&quot;code classlanguage textknnk nearest neighborcode permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;strong&gt;&lt;code class=&quot;language-text&quot;&gt;kNN(k-Nearest Neighbor)&lt;/code&gt;&lt;/strong&gt;&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;Model &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; `KNeighborsClassifier&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;`
Grid search&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    n_neighbors&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;
    p&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
    meric &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; ‘minkowski’&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;지도학습&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;테스트 데이터에서 k개의 가장 가까운 이웃을 찾고, 그 이웃들 중 다수가 속한 클래스가 테스트 데이터의 클래스가 되게 한다&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;iris 패키지: “새로운 꽃이 발견됐을 때, 어느 종류(클래스)에 넣는 것이 좋을까?&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;레이지 러닝(lazy learning)&lt;/code&gt;: 미리 학습해 두는 방식이 아니라, test data 추정할 때마다 학습하기 때문에 시간이 오래 걸림&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt; &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/ff8f151393663889633470d0077aac0f/32056/image-20200721074726342.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 33.78378378378378%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAABaUlEQVQoz12RWW+cQBCE+f//ycpLFMkvibw2dizYBZZz1zBcM9zwpZfN3VJLoyl1VVeXZcqSqWn4u9Z1o7r9ty3LMPyDDeNIU1XMMrN2HUzTbWDHtm3D0qpAfX9jiCPmYSS4NJh+oiwVOolR9gtbU6PbjiTXdH1PqRT12yu15wnZwse14lq0O6ll4oypqFh9j9fDiW/HDxluiJOU/hyzXHOM5/P4FBBdG/IiJ49ThnPCJpte3IDPh4imNnfCMDkQ5geWWeMnNZUZdyAIXeL0WZTfGVuD7aRMy0ZnOvyzTRx9pdUJqux5d9Ob4TuhF9k8OQ+i7gjpitYtXdeTZCHB9Rnb+8Q4mZ+3XekFi7ITx/gR1/8C88wqd1yWZW+rl42MqHr+iaJQ8jbUdS3d0OmB7JJwOh2pxF4pQd26qTVG9+LCI4zErgSk5K6thGj9Si/LLqRpwv819AOu6+6Ef+puT6kSx3Ek6Ok38gNsshT7lN4ElQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;image-20200721074726342&quot;
        title=&quot;image-20200721074726342&quot;
        src=&quot;/static/ff8f151393663889633470d0077aac0f/fcda8/image-20200721074726342.png&quot;
        srcset=&quot;/static/ff8f151393663889633470d0077aac0f/12f09/image-20200721074726342.png 148w,
/static/ff8f151393663889633470d0077aac0f/e4a3f/image-20200721074726342.png 295w,
/static/ff8f151393663889633470d0077aac0f/fcda8/image-20200721074726342.png 590w,
/static/ff8f151393663889633470d0077aac0f/32056/image-20200721074726342.png 602w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;그림 출처: 심교훈. 2019. 10. 8. &quot;유유상종의 진리를 이용한 분류 모델, kNN(k-Nearest Neighbor)&quot;. &lt;a href=&quot;https://bskyvision.com/563&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://bskyvision.com/563&lt;/a&gt;. b스카이비전&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;K 가 작을수록 복잡도 높아짐&lt;/p&gt;
&lt;p&gt;→ 과잉적합&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;K가 증가할수록 정확도가 떨어진다&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;거리 측정 방법:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;맨하튼 거리: 가장 심플&lt;/li&gt;
&lt;li&gt;유클리디안 거리: 최단 거리&lt;/li&gt;
&lt;li&gt;민코우스키 거리: 많이 떨어진 성분 부각&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;
&lt;br&gt;
&lt;h2 id=&quot;code-classlanguage-text결정-트리decision-treecode&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#code-classlanguage-text%EA%B2%B0%EC%A0%95-%ED%8A%B8%EB%A6%ACdecision-treecode&quot; aria-label=&quot;code classlanguage text결정 트리decision treecode permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;strong&gt;&lt;code class=&quot;language-text&quot;&gt;결정 트리(Decision Tree)&lt;/code&gt;&lt;/strong&gt;&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;Model &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; DecisionTreeClassifier&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; grid search&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 
    criterion&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;’gini’
    알파&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;가중치&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    max_depth&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;k
    pd&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Categorical&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;income&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;c&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;codes
    dt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;feature_importances ← 중요도 분석
    path &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; `DecisionTreeClassifier&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cost_complexity_pruning_path&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;trainX&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; trainY&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    ccp_alpha &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; ccp_alpha
    &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; 이때 먼저&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; ccp_alpha &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; `ccp_alphas&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;where&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ccp_alphas &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.001&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;`
    clfs&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;tree_&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;node_count &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt; clfs&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;tree_&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;max_depth&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;지도학습, 비지도학습&lt;/li&gt;
&lt;li&gt;알파값(가중치 조정) 높이기 ~ 오분류율(불순도) 증가&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;핵심: 변별력이 좋은 질문을 위에서부터 하나하나 세팅&lt;/p&gt;
&lt;br&gt;
&lt;/li&gt;
&lt;li&gt;Feature가 3개 이상이면 초평면으로 구분&lt;/li&gt;
&lt;li&gt;Featrue(차원)이 많아져도 덜 중요한 feature는 분류 기준에서 제외되어 feature 선정에 크게 신경 쓸 필요 X&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;중요한 Feature 확인 가능&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;중요도 분석&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Tree 과도하게 분할( = 과잉 적합 = 트리가 복잡) → 아래 노드에 데이터 小 → 데이터 단편화 → 유의미한 결정 내리기 어려움&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;즉, Depth 높 ~ 트리 길어짐 ~ 과도하게 분할 ~ overfitting ~ 정확도 낮음&lt;/li&gt;
&lt;li&gt;해결 위해 정지기준 or 사전/사후 가지치기 사용&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;정지기준&lt;/code&gt;: depth 지정 or 마지막 노드의 데이터 수가 임계치 이하로 떨어지지 않도록 지정&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;알파(가중치): depth 조정&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;가지치기&lt;/code&gt;: 트리 단순화하여 일반화 특성 향상시키기.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;사전 가지치기&lt;/code&gt;: depth, 마지막 노드의 최소 데이터 수, 불순척도(criterion)&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;사후 가지치기&lt;/code&gt;: 오분류율, 패널티항, 알파(가중치)&lt;/li&gt;
&lt;/ol&gt;
 &lt;br&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;ID3 알고리즘&lt;/code&gt;: 정보량과 엔트로피 개념 활용&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;알고리즘 &lt;strong&gt;순서&lt;/strong&gt;: &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;엔트로피 계산량에 의해 엔트로피(E)가 낮고, &lt;/li&gt;
&lt;li&gt;정보획득량(IG)가 높은 선택지를 선택함&lt;/li&gt;
&lt;li&gt;온도 속성은 끝내 결정 노드에 쓰이지 않았다. 4개의 속성 중에 가장 변별력이 낮은 속성이었던 것이다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;불순척도(지니지수, 엔트로피) 작아지도록 분할 기준 선택. 분할 전 부모노드 보다 분할 후 자식노드의 불순척도가 작아지는 게 좋음(IG)&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;지니지수&lt;/code&gt;: 0~0.5값&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code class=&quot;language-text&quot;&gt;정보량&lt;/code&gt;&lt;/strong&gt;: 어떤 사건이 가지고 있는 정보의 양. 드물게 발생하는 일일수록 정보량이 크다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code class=&quot;language-text&quot;&gt;엔트로피&lt;/code&gt;&lt;/strong&gt;(E): 0~1값 정보량의 기댓값(평균). 발생한 사건들의 정보량을 모두 구해서 (가중)평균&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;엔트로피가 크다는 것은 평균정보량이 크다는 것&lt;/li&gt;
&lt;li&gt;대개 사건들이 일어날 확률이 비슷한 경우에 엔트로피가 크다.&lt;/li&gt;
&lt;li&gt;따라서 두 사건이 0.5, 0.5 확률로 일어날 때의 엔트로피가 가장 크다&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;→ 즉, &lt;strong&gt;불확실성이&lt;/strong&gt; 클수록 엔트로피가 크다&lt;/p&gt;
&lt;p&gt;→ 불확실성이 크면 클수록 분류하기는 어려워짐&lt;/p&gt;
&lt;p&gt;→ 엔트로피가 가장 작은 것을 상위 의사결정 노드에 위치시켜야 함.&lt;/p&gt;
&lt;p&gt;→ 이를 위해 &lt;strong&gt;&lt;code class=&quot;language-text&quot;&gt;정보획득량&lt;/code&gt;&lt;/strong&gt;(IG)이란 개념이 필요&lt;/p&gt;
&lt;p&gt;&quot;어떤 속성을 가지고 분류했을 때 가장 엔트로피(불확실성)가 작은지, 정보획득량이 큰지&quot;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;
&lt;br&gt;
&lt;h2 id=&quot;code-classlanguage-text서포트-벡터-머신svmcode&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#code-classlanguage-text%EC%84%9C%ED%8F%AC%ED%8A%B8-%EB%B2%A1%ED%84%B0-%EB%A8%B8%EC%8B%A0svmcode&quot; aria-label=&quot;code classlanguage text서포트 벡터 머신svmcode permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;strong&gt;&lt;code class=&quot;language-text&quot;&gt;서포트 벡터 머신(SVM)&lt;/code&gt;&lt;/strong&gt;&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;Model &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; SVC&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
grid search &lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 
    kernel &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; ‘linear’
    C
    gamma
    &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;비선형&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;multiclassification&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; kernel &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; `‘rbf’
     &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; 파라미터 C는 이상치 또는 오류를 얼마나 허용하는 가&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;복잡도 조절&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;를 정해주고&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; gamma는 결정 경계의 곡률을 결정
        &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; C&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;max&lt;/span&gt; margin &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;min&lt;/span&gt; 섞임 조절
        &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; C&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 大 &lt;span class=&quot;token operator&quot;&gt;~&lt;/span&gt; 패널티항 大 &lt;span class=&quot;token operator&quot;&gt;~&lt;/span&gt; 거리 짧음&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/br&gt;
&lt;ul&gt;
&lt;li&gt;가장 많이 사용되는 SVM은 radial(방사형) basis function (RBF) 커널을 사용한 SVM&lt;/li&gt;
&lt;li&gt;SVM은 일반화 특성이 우수&lt;/li&gt;
&lt;li&gt;
&lt;blockquote&gt;
&lt;p&gt; 모델 생성시 특정 옵션을 주어야 &lt;code class=&quot;language-text&quot;&gt;predict_proba&lt;/code&gt;가 사용 가능&lt;/p&gt;
&lt;p&gt;predict_proba 함수를 가지고 있지만, 모델 생성시 &lt;code class=&quot;language-text&quot;&gt;probalility=True&lt;/code&gt;를 설정하지 않으면 사용할 수 없다.&lt;/p&gt;
&lt;p&gt;이때, 레이블이 3개 이상인 경우, LinearSVC보단 SVC를 사용하고, probability=True 옵션 주는 것을 추천한다. &lt;/p&gt;
&lt;p&gt;출처: &lt;a href=&quot;https://m.blog.naver.com/cjh226/221358912619&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://m.blog.naver.com/cjh226/221358912619&lt;/a&gt;)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;
&lt;h3 id=&quot;선형-svm&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%84%A0%ED%98%95-svm&quot; aria-label=&quot;선형 svm permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;strong&gt;선형 SVM&lt;/strong&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;데이터를 선형으로 분리하는 최적의 선형 결정 경계를 찾는 알고리즘&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;그 중 가장 간단한 것이 선형 SVM(linear SVM)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;SVM 알고리즘의 목표: 클래스가 다른 데이터들을 가장 큰 마진(margin)으로 분리해내는 선 또는 면(결정 경계 또는 분리 초평면)을 찾아내는 것&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;마진: 두 데이터 군과 결정 경계와 떨어져있는 정도&lt;/li&gt;
&lt;li&gt;서포트 벡터: 결정 경계와 가장 먼저 만나는 데이터&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;SVM의 기본 매개변수인 C&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;cost(C): C는 얼마나 많은 데이터 샘플이 다른 클래스에 놓이는 것을 허용하는지를 결정&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ex: 작을 수록 많이 허용, 클 수록 적게 허용&lt;/li&gt;
&lt;li&gt;ex: C값을 낮게 설정하면 이상치들이 있을 가능성을 크게 잡아 일반적인 결정 경계를 찾아내고, 높게 설정하면 반대로 이상치의 존재 가능성을 작게 봐서 좀 더 세심하게 결정 경계를 찾아낸다.&lt;/li&gt;
&lt;li&gt;ex: &quot;난 데이터 샘플하나도 잘못 분류할 수 없어!&quot; : C를 높여야&lt;/li&gt;
&lt;li&gt;ex: &quot;몇 개는 놓쳐도 괜찮아, 이상치들이 꽤 있을 수도 있으니까&quot; : C를 낮춰야&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;C가 너무 낮으면 과소적합(underfitting)&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;C가 너무 높으면 과대적합(overfitting)&lt;/p&gt;
&lt;p&gt;→ 적합한 C값을 찾아내는 것이 중요&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;하드마진(hard-margin) SVM&lt;/li&gt;
&lt;li&gt;소프트마진(soft-margin) SVM&lt;/li&gt;
&lt;/ul&gt;
 &lt;/br&gt;
&lt;h3 id=&quot;rbf-커널-svm&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#rbf-%EC%BB%A4%EB%84%90-svm&quot; aria-label=&quot;rbf 커널 svm permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;strong&gt;RBF 커널 SVM&lt;/strong&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;커널 기법은 주어진 데이터를 고차원 특징 공간으로 사상해주는 것이다.&lt;/li&gt;
&lt;li&gt;3차원 공간에서 분류된 것을 다시 2차원 공간으로 매핑해서 보면 결정 경계가 둥그렇게 보일 것&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;RBF 커널의 경우 gamma라는 매개변수를 사용자가 조정해야 한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;gamma&lt;/code&gt; : 하나의 데이터 샘플이 영향력을 행사하는 거리를 결정&lt;/li&gt;
&lt;li&gt;ex: gamma가 클수록 한 데이터 포인터들이 영향력을 행사하는 거리가 짧아지는 반면, 낮을수록 커진다&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ex: gamma는 가우시안 함수의 표준편차와 관련되어 있는데, 클수록 작은 표준편차를 의미&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&apos;편차가 크다&apos;: 어떤 자료는 평균보다 엄청 크고 어떤 자료는 평균보다 엄청 작다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;gamma 매개변수는 결정 경계의 곡률을 조정한다고 말할 수도 있다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;gamma의 값이 높아짐에 따라 공간이 점점 작아지는데, 위에서 언급한 것과 같이 각각의 데이터 포인터가 영향력을 행사하는 거리가 짧아졌기 때문 &amp;#x3C;- 아마 정확도가 높아질 듯하다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;매개변수 C와 마찬가지로 너무 낮으면 과소적합될 가능성이 크고, 너무 높으면 과대적합의 위험이 있다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;두 값 모두 커질수록 알고리즘의 복잡도는 증가하고, 작아질수록 복잡도는 낮아진다.&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;
&lt;h2 id=&quot;선형-회귀linear-regression&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%84%A0%ED%98%95-%ED%9A%8C%EA%B7%80linear-regression&quot; aria-label=&quot;선형 회귀linear regression permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;strong&gt;선형 회귀(linear regression)&lt;/strong&gt;&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;Model &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; LinearRegression&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;예측값(Y햇)이 실수(연속형)일 떈, ‘.mean’, ‘.score’ 말고 R2(*0~1값을 가짐) 사용(값의 범위가 MSE보다 작기 때문)&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;선형회귀는 사용되는 &apos;특성(feature)의 개수&apos;에 따라 &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;단순 선형 회귀(simple linear regression): 단 하나의 특징(feature)을 가지고 라벨값(label) 또는 타깃(target)을 예측하기 위한 회귀 모델을 찾는다.&lt;/li&gt;
&lt;li&gt;다중 선형 회귀(multiple linear regression): 하나의 특성이 아닌 여러 개의 특성을 활용해서 회귀모델을 만듦&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;선형 회귀는 y와 y햇 사이의 평균제곱오차(mean squared error, MSE)를 최소화하는 파라미터(w, b)&lt;/strong&gt;를 찾는다. y와 y햇의 차이가 작으면 작을 수록 예측 성능이 좋기 때문&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;라쏘(Lasso):&lt;/strong&gt; 선형 회귀의 단점을 극복하기 위해 개발된 방법&lt;/li&gt;
&lt;li&gt;linear regression에선 predict_proba 함수를 제공하지 않는다&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;y햇 = w[0]+x[0]+b&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;w: 가중치(weight), 계수(coefficient)&lt;/li&gt;
&lt;li&gt;b: 편항(offset)&lt;/li&gt;
&lt;li&gt;y햇: 예측값&lt;/li&gt;
&lt;li&gt;x[0]: 특징&lt;/li&gt;
&lt;li&gt;&quot;feature와 lable 사이의 관계를 잘 설명해낼 수 있는 최적(가장 적합한)의 w와 b를 찾는 것&quot;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;
&lt;h3 id=&quot;code-classlanguage-text라쏘l1code&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#code-classlanguage-text%EB%9D%BC%EC%8F%98l1code&quot; aria-label=&quot;code classlanguage text라쏘l1code permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;strong&gt;&lt;code class=&quot;language-text&quot;&gt;라쏘(L1)&lt;/code&gt;&lt;/strong&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;추가 제약조건이자 grid search&lt;/li&gt;
&lt;li&gt;선형 회귀에 &lt;strong&gt;L1&lt;/strong&gt; 규제를 줘서 과대적합을 피하는 방법이다.&lt;/li&gt;
&lt;li&gt;상관성이 있을 수도 있는 feature의 영향력을 줄일 수 있음&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;동작 원리:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;MSE가 최소가 되게 하는 w, b 찾기 + w의 모든 원소가 0이 되거나 0에 가깝게&lt;/li&gt;
&lt;li&gt;MSE와 penalty 항의 합이 최소가 되게 하는 w와 b를 찾는 것이 라쏘의 목적&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;L1-norm(벡터의 요소들의 절대값들의 합) 패널티를 조정하는 건 알파값(선형회귀 분석의 grid serch)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;알파 너무 작으면 과대적합(복잡도 큼), 너무 크면 과소 적합(복잡도 넘 작음)&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;라쏘의 장점:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;제약 조건을 통해 일반화된 모형을 찾는다.&lt;/li&gt;
&lt;li&gt;모델 해석력이 good (모델에서 가장 중요한 특성이 무엇인지 아는)&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;총 105개의 특성을 라쏘 회귀 모델을 만들기 위해 사용했다. &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 36px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/de1e4e5f483c13ccd70931eaeed07ced/b501b/image-20200721081736446.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 47.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABKklEQVQoz4VSu6qDUBDMN/oDqfIDaUQwKVPHTiwEg11Io0hSBFJaWIgkihGSVisfnfiae/eAYmJy78B6luXM7O4cZ/hF13Xoz/9ijKZpMOYTZu9ihLZtJ+SxqOu6WK/XeDwew/1B8L3DOO+FKXpSkiSwbRuLxQJBEEwFe4GqqnA6nXA4HHA+n7Hf72GaJjabDbbbLTuv1+tAXK1W8H1/stGsV9c0DcfjEVmWYT6fw3EcVq/rmhHIr/5uWZbgeR63220qSJ88z7FcLlnBMAxIksTyy+UCWZax2+2gKAqiKBomFEXxu4fUURAEWJYFXddZTpPGcczWDMOQTUM1Ak3PcRxUVUWapi/eDx6S2ff7neUkUBQFPoFWfz6f8DzvpcnLyn+98jjef6VPnB+lqpvwRtKYcAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;image-20200721081736446&quot;
        title=&quot;image-20200721081736446&quot;
        src=&quot;/static/de1e4e5f483c13ccd70931eaeed07ced/b501b/image-20200721081736446.png&quot;
        srcset=&quot;/static/de1e4e5f483c13ccd70931eaeed07ced/b501b/image-20200721081736446.png 36w&quot;
        sizes=&quot;(max-width: 36px) 100vw, 36px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;로 설정했더니 105개의 가중치 중에서 101개가 0이 되면서 특성은 단 4개만 사용되었다. 훈련셋에서의 점수와 테스트셋에서의 점수를 보니 과소적합이었다. 따라서 복잡도를 높이기 위해서 &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 73px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/342cd0d147b9f829aaa817345be1c855/2bc29/image-20200721081835369.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 23.287671232876715%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAAA9klEQVQY021QyYqDUBDM/3+AJyF3QTEuwagHb+KCBESIghAQRC+K4oKg1tAdJsxh6vDorep11+U8T/yHqqowzzPH0zRxTmiaBn3fc/x+v3EcB9Z1/dYu9AzDgHEcUdc1N16vF0zThG3bPOS6Lu73O3zf59hxHARBAF3XEccx0jSFJEkfQUoMw4BlWYiiCEmSMJnqmqZh2zaoqoo8zyEIAp7PJzzPw/V6RVEUPLssC/NZkDaRZZkFaCDLMiYrioIwDFGWJZMejwdvfrvdeDv6mHjUp9NFUfwIkjqdSz78BZ1O/pB/tCXZ8msP5YSu674et22Lfd/xAzbWZmyVUan7AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;image-20200721081835369&quot;
        title=&quot;image-20200721081835369&quot;
        src=&quot;/static/342cd0d147b9f829aaa817345be1c855/2bc29/image-20200721081835369.png&quot;
        srcset=&quot;/static/342cd0d147b9f829aaa817345be1c855/2bc29/image-20200721081835369.png 73w&quot;
        sizes=&quot;(max-width: 73px) 100vw, 73px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;로 설정했더니 가중치 중에서 7개만 0이 되면서 94개의 특성이 사용되었다. 훈련셋과 테스트셋에서의 점수를 보니 훈련셋에서는 좋은데 테스트셋에서는 많이 떨어졌다. 즉, 과대적합이었다. 따라서 다시 복잡도를 낮추기 위해 &lt;img src=&quot;https://t1.daumcdn.net/cfile/tistory/99E9B0335A0547A912&quot; alt=&quot;img&quot;&gt;을 사용했다. 105개의 가중치 중에서 72개가 0이 되면서 33개의 특성이 사용되었다. 훈련셋에서의 점수와 테스트셋에서의 점수가 모두 괜찮았다. &lt;/p&gt;
&lt;/blockquote&gt;
&lt;br&gt;
&lt;h3 id=&quot;code-classlanguage-text릿지l2code&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#code-classlanguage-text%EB%A6%BF%EC%A7%80l2code&quot; aria-label=&quot;code classlanguage text릿지l2code permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;릿지(L2)&lt;/code&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;L2-norm&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;릿지 원의 크기와 라쏘의 마름모 크기는 정규화 역할하는 람다 혹은 C로 조절&lt;/li&gt;
&lt;li&gt;특성이 다수일 경우에는 릿지 회귀가 좀 더 잘 작동. 선형 회귀와 달리 모델의 복잡도를 조정할 수 있기 때문. 복잡도를 조정할 수 있다는 말은 사용자가 설정 가능한 파라미터가 있다는 뜻&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;알파값(가중치)&lt;/strong&gt;: (feature가 생각보다 덜 쓰였다던가의)과소적합: 1보다 작은 α 값(ex: 0.1, 0.01, 0.001)로 조정&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;즉, alpha 값을 크게 설정 ~ 기울기가 줄어듦 ~ 특성들이 출력에 미치는 영향력이 줄어듦(현재 특성들에 덜 의존)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;alpha = 0 ← 선형회귀&lt;/li&gt;
&lt;li&gt;default : alpha = 1&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;정리&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;특성이 많은데 그중 &lt;strong&gt;일부분만 중요하다면 라쏘&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;특성의 중요도가 전체적으로 &lt;strong&gt;비슷하다면 릿지&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;
&lt;br&gt;
&lt;h2 id=&quot;code-classlanguage-text로지스틱-회귀-분석code&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#code-classlanguage-text%EB%A1%9C%EC%A7%80%EC%8A%A4%ED%8B%B1-%ED%9A%8C%EA%B7%80-%EB%B6%84%EC%84%9Dcode&quot; aria-label=&quot;code classlanguage text로지스틱 회귀 분석code permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;로지스틱 회귀 분석&lt;/code&gt;&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;model &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Logisticregression&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
grid search&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    penaly &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; ‘l2’
    C &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; c
    max_iter &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;500&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;선형회귀분석에서 쓰던 MSE 말고 Cross Entropy(CE) 사용&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;오즈&lt;/strong&gt;(0.9가 나왔으면 1이라 보는 것)&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;계산 시 유의 사항:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;예측값(y햇)이 실제값(y)과에 가깝게 나오게 하기 위해 CE, MSE 최소화&lt;/li&gt;
&lt;li&gt;출력에 1이 여러 개인(sigmoid 출력) 이진분류일 경우 &lt;strong&gt;BCE&lt;/strong&gt;(바이너리 CE) 사용: 개별 출력이라 1이 여러 개&lt;/li&gt;
&lt;li&gt;출력에 1이 한 개일 경우(one-shot 형태로 softmax가 출력) &lt;strong&gt;CCE&lt;/strong&gt;(카테고리컬 CE) 사용: 그룹(?) 출력이라 1이 하나&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;→ BCE, CCE는 결과가 다르고 정확도 측정도 달라지므로 주의해서 선택&lt;/p&gt;
&lt;br&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;sklearn 패키지에서는 sigmoid 안 거치고 바로 softmax로 감&lt;/p&gt;
&lt;br&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;보통의 계산 순서: &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;sigmoid 함수로 계산&lt;/li&gt;
&lt;li&gt;softmax함수로 계산(이때 CE 사용)&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
 &lt;br&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;로지스틱함수의 yHat 계산법(step):&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;시그모이드 계산&lt;/li&gt;
&lt;li&gt;시그모이드(sigmoid) 함수: 가중치와 바이어스는 시그모이드의 비활성도를 조절해준다.&lt;/li&gt;
&lt;li&gt;CE 계산&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;
 &lt;br&gt;
&lt;h2 id=&quot;code-classlanguage-text나이브-베이지안code&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#code-classlanguage-text%EB%82%98%EC%9D%B4%EB%B8%8C-%EB%B2%A0%EC%9D%B4%EC%A7%80%EC%95%88code&quot; aria-label=&quot;code classlanguage text나이브 베이지안code permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;나이브 베이지안&lt;/code&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;model = GaussianNB()&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Feature들이 서로 독립이라 가정&lt;/strong&gt;하고 &lt;strong&gt;조건부 확률 계산&lt;/strong&gt;해서 데이터 분류&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;명목형&lt;/strong&gt;(1, 0), &lt;strong&gt;연속형&lt;/strong&gt;(정규분포 사용) 변수 모두 사용 가능&lt;/p&gt;
&lt;br&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;계산 순서:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;결합 확률은 너무 복잡해서 두 feature를 독립이라 가정하여,&lt;/li&gt;
&lt;li&gt;베이지안 식에 의해 각각을 곱해 계산한 후,&lt;/li&gt;
&lt;li&gt;큰 확률의 값을 선택&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt; Ex: yes 일 확률 : 1 , no일 확률: 0 =&gt; (계산 후) no로 분류&lt;/p&gt;
 &lt;br&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;m 추정치(m-Estimates)&lt;/code&gt;: 비교하려는 두 샘플의 data 중에 특정 데이터가 없을 땐 두 확률이 모두 0으로 나와서 분류할 수 없으므로, m-Estimates라는 m과 p를 사용해서 조건부 확률 계산식을 조정함. &lt;/li&gt;
&lt;li&gt;분모의 m은 임의의 확률, mp는 분자가 0 나오는 거 방지&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;명목형, 연속형 모두 섞여 있는 data 일 땐,&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;명목형, 연속형 각각 model 학습&lt;/li&gt;
&lt;li&gt;각각의 model 정확도 추정&lt;/li&gt;
&lt;li&gt;&apos;2&apos;의 그 정확도(확률)을 곱함&lt;/li&gt;
&lt;li&gt;&apos;3&apos;의 확률의 곱으로 정확도 측정&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;blockquote&gt;
&lt;p&gt; 참고: &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;심교훈. 019. 10. 24. &quot;결정 트리(Decision Tree) 알고리즘, ID3 소개&quot;. &lt;a href=&quot;https://bskyvision.com/598&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://bskyvision.com/598&lt;/a&gt;. b스카이비전.&lt;/li&gt;
&lt;li&gt;심교훈. 2020. 1. 20. &quot;[ubuntu+python] 선형 회귀의 업그레이드 버전1, 릿지 회귀&quot;. &lt;a href=&quot;https://bskyvision.com/687&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://bskyvision.com/687&lt;/a&gt;. b스카이비전&lt;/li&gt;
&lt;li&gt;심교훈. 2017. 10. 21. &quot;서포트 벡터 머신(SVM)의 사용자로서 꼭 알아야할 것들 - 매개변수 C와 gamma&quot;. &lt;a href=&quot;https://bskyvision.com/163&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://bskyvision.com/163&lt;/a&gt;. b스카이비전.&lt;/li&gt;
&lt;li&gt;머신러닝. 2020.01.14. &quot;서포트 벡터 머신(Support Vector Machine) 쉽게 이해하기&quot;. &lt;a href=&quot;http://hleecaster.com/ml-svm-concept/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;http://hleecaster.com/ml-svm-concept/&lt;/a&gt;. 아무튼워라밸&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;</content:encoded></item></channel></rss>